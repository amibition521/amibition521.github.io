<!doctype html>




<html class="theme-next pisces" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="图[TOC] 无向图图：是由一组顶点和一组能够将两个顶点相连的边组成的。点： Vertex, 边：Edge; 路径： 是由边顺序连接的一系列顶点。 连通图：从任意一个顶点都存在一条路径到达另一个任意顶点，称为连通图。 树：是一副无环连通图。 当且仅当一幅含有 V 个结点的图 G 满足下列5个条件之一时，它就是一个树：  G 有 V- 1 条边且不含有环 G 有 V- 1条边且是连通的 G 是连通的">
<meta name="keywords">
<meta property="og:type" content="article">
<meta property="og:title" content="图相关算法">
<meta property="og:url" content="http://yoursite.com/2018/06/21/图相关算法/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="图[TOC] 无向图图：是由一组顶点和一组能够将两个顶点相连的边组成的。点： Vertex, 边：Edge; 路径： 是由边顺序连接的一系列顶点。 连通图：从任意一个顶点都存在一条路径到达另一个任意顶点，称为连通图。 树：是一副无环连通图。 当且仅当一幅含有 V 个结点的图 G 满足下列5个条件之一时，它就是一个树：  G 有 V- 1 条边且不含有环 G 有 V- 1条边且是连通的 G 是连通的">
<meta property="og:updated_time" content="2018-06-21T08:29:32.294Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="图相关算法">
<meta name="twitter:description" content="图[TOC] 无向图图：是由一组顶点和一组能够将两个顶点相连的边组成的。点： Vertex, 边：Edge; 路径： 是由边顺序连接的一系列顶点。 连通图：从任意一个顶点都存在一条路径到达另一个任意顶点，称为连通图。 树：是一副无环连通图。 当且仅当一幅含有 V 个结点的图 G 满足下列5个条件之一时，它就是一个树：  G 有 V- 1 条边且不含有环 G 有 V- 1条边且是连通的 G 是连通的">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/06/21/图相关算法/"/>





  <title> 图相关算法 | Hexo </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/图相关算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="喝咖啡的鱼儿">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                图相关算法
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-21T16:26:06+08:00">
                2018-06-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="图"><a href="#图" class="headerlink" title="图"></a>图</h2><p>[TOC]</p>
<h3 id="无向图"><a href="#无向图" class="headerlink" title="无向图"></a>无向图</h3><p>图：是由一组顶点和一组能够将两个顶点相连的边组成的。点： Vertex, 边：Edge;</p>
<p>路径： 是由边顺序连接的一系列顶点。</p>
<p>连通图：从任意一个顶点都存在一条路径到达另一个任意顶点，称为连通图。</p>
<p>树：是一副无环连通图。</p>
<p>当且仅当一幅含有 V 个结点的图 G 满足下列5个条件之一时，它就是一个树：</p>
<ul>
<li>G 有 V- 1 条边且不含有环</li>
<li>G 有 V- 1条边且是连通的</li>
<li>G 是连通的， 但删除任意一条边都会使它不再连通</li>
<li>G 是无环图，但添加任意一条边都会产生一个环</li>
<li>G 中的任意一对顶点之间仅存在一条简单路径。</li>
</ul>
<h4 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h4><p>定义：将每个顶点的所有相邻顶点都保存在该顶点对应的元素所指向的一张链表中。</p>
<p>特点：</p>
<ol>
<li>使用的空间和 V + E  成正比</li>
<li>添加一条边所需的时间为常数</li>
<li>遍历顶点 V 的所有相邻顶点所需的时间和 V 的度数成正比；</li>
</ol>
<p>图的 API 表示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Graph</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String NEWLINE = System.getProperty(<span class="string">"line.separator"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> V;  <span class="comment">//顶点数目</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> E;			<span class="comment">//边的数目</span></div><div class="line">    <span class="keyword">private</span> Bag&lt;Integer&gt;[] adj; <span class="comment">//邻接表</span></div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty graph with &#123;<span class="doctag">@code</span> V&#125; vertices and 0 edges.</div><div class="line">     * param V the number of vertices</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  V number of vertices</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> V &lt; 0&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Graph</span><span class="params">(<span class="keyword">int</span> V)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (V &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of vertices must be nonnegative"</span>);</div><div class="line">        <span class="keyword">this</span>.V = V;</div><div class="line">        <span class="keyword">this</span>.E = <span class="number">0</span>;</div><div class="line">        adj = (Bag&lt;Integer&gt;[]) <span class="keyword">new</span> Bag[V];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            adj[v] = <span class="keyword">new</span> Bag&lt;Integer&gt;();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a new graph that is a deep copy of &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  G the graph to copy</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Graph</span><span class="params">(Graph G)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(G.V());</div><div class="line">        <span class="keyword">this</span>.E = G.E();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="comment">// reverse so that adjacency list is in same order as original</span></div><div class="line">            Stack&lt;Integer&gt; reverse = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj[v]) &#123;</div><div class="line">                reverse.push(w);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : reverse) &#123;</div><div class="line">                adj[v].add(w);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of vertices in this graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of vertices in this graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">V</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> V;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of edges in this graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of edges in this graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">E</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> E;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Adds the undirected edge v-w to this graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v one vertex in the edge</div><div class="line">     * <span class="doctag">@param</span>  w the other vertex in the edge</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless both &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125; and &#123;<span class="doctag">@code</span> 0 &lt;= w &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        validateVertex(w);</div><div class="line">        E++;</div><div class="line">        adj[v].add(w);</div><div class="line">        adj[w].add(v);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the vertices adjacent to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the vertices adjacent to vertex &#123;<span class="doctag">@code</span> v&#125;, as an iterable</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Integer&gt; <span class="title">adj</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> adj[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the degree of vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the degree of vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">degree</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> adj[v].size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a string representation of this graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of vertices &lt;em&gt;V&lt;/em&gt;, followed by the number of edges &lt;em&gt;E&lt;/em&gt;,</div><div class="line">     *         followed by the &lt;em&gt;V&lt;/em&gt; adjacency lists</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder s = <span class="keyword">new</span> StringBuilder();</div><div class="line">        s.append(V + <span class="string">" vertices, "</span> + E + <span class="string">" edges "</span> + NEWLINE);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            s.append(v + <span class="string">": "</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : adj[v]) &#123;</div><div class="line">                s.append(w + <span class="string">" "</span>);</div><div class="line">            &#125;</div><div class="line">            s.append(NEWLINE);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> s.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> Graph&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        Graph G = <span class="keyword">new</span> Graph(in);</div><div class="line">        StdOut.println(G);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="深度优先搜索—-DFS"><a href="#深度优先搜索—-DFS" class="headerlink" title="深度优先搜索— DFS"></a>深度优先搜索— DFS</h3><p>要搜索一副图，只需用一个递归方法来遍历所有的顶点，在访问其中一个顶点时：</p>
<ul>
<li>将它标记为已访问；</li>
<li>递归地访问它的所有没有被标记过的邻居顶点。</li>
</ul>
<p>解决问题：</p>
<ol>
<li>连通性，两个顶点是否连通？</li>
<li>单点路径问题，从 s 到给定目的顶点v 是否存在一条路径？</li>
</ol>
<h4 id="寻找路径"><a href="#寻找路径" class="headerlink" title="寻找路径"></a>寻找路径</h4><h5 id="使用深度优先搜索查找图中的路径"><a href="#使用深度优先搜索查找图中的路径" class="headerlink" title="使用深度优先搜索查找图中的路径"></a>使用深度优先搜索查找图中的路径</h5><p>DepthFirstPaths.java</p>
<p>其中 <code>edge[]</code> 记录着每个顶点到起点的路径，而不是记录当前顶点到起点的路径；例如：在由边 v - w 第一次访问任意 w 时，将 <code>edge[w] = v</code> 来记录这条路径。换句话说，v - w 是从 s 到 w 的路径上的最后一条已知边；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DepthFirstPaths</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] marked;    <span class="comment">// marked[v] = is there an s-v path?</span></div><div class="line">    <span class="comment">//记录顶点 从起点到一个顶点的已知路径上的最后一个顶点</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] edgeTo;        <span class="comment">// edgeTo[v] = last edge on s-v path, </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> s;         <span class="comment">// source vertex</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes a path between &#123;<span class="doctag">@code</span> s&#125; and every other vertex in graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@param</span> G the graph</div><div class="line">     * <span class="doctag">@param</span> s the source vertex</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DepthFirstPaths</span><span class="params">(Graph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.s = s;</div><div class="line">        edgeTo = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        validateVertex(s);</div><div class="line">        dfs(G, s);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// depth first search from v</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(Graph G, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        marked[v] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">            <span class="keyword">if</span> (!marked[w]) &#123;</div><div class="line">                edgeTo[w] = v;</div><div class="line">                dfs(G, w);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is there a path between the source vertex &#123;<span class="doctag">@code</span> s&#125; and vertex &#123;<span class="doctag">@code</span> v&#125;?</div><div class="line">     * <span class="doctag">@param</span> v the vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a path, &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> marked[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a path between the source vertex &#123;<span class="doctag">@code</span> s&#125; and vertex &#123;<span class="doctag">@code</span> v&#125;, or</div><div class="line">     * &#123;<span class="doctag">@code</span> null&#125; if no such path.</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the sequence of vertices on a path between the source vertex</div><div class="line">     *         &#123;<span class="doctag">@code</span> s&#125; and vertex &#123;<span class="doctag">@code</span> v&#125;, as an Iterable</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Integer&gt; <span class="title">pathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">if</span> (!hasPathTo(v)) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        Stack&lt;Integer&gt; path = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = v; x != s; x = edgeTo[x])</div><div class="line">            path.push(x);</div><div class="line">        path.push(s);</div><div class="line">        <span class="keyword">return</span> path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = marked.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> DepthFirstPaths&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        Graph G = <span class="keyword">new</span> Graph(in);</div><div class="line">        <span class="keyword">int</span> s = Integer.parseInt(args[<span class="number">1</span>]);</div><div class="line">        DepthFirstPaths dfs = <span class="keyword">new</span> DepthFirstPaths(G, s);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">if</span> (dfs.hasPathTo(v)) &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d:  "</span>, s, v);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x : dfs.pathTo(v)) &#123;</div><div class="line">                    <span class="keyword">if</span> (x == s) StdOut.print(x);</div><div class="line">                    <span class="keyword">else</span>        StdOut.print(<span class="string">"-"</span> + x);</div><div class="line">                &#125;</div><div class="line">                StdOut.println();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d:  not connected\n"</span>, s, v);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>要找出 s 到任意顶点 v 的路径，<code>pathTo()</code> 方法用变量 <code>x</code> 遍历整棵树，将 <code>x</code> 设为 <code>edge[x]</code>  ，然后在到达 s 之前，将遇到的所有顶点都压入栈中。将这个栈返回为一个 Iterable 对象帮助用例遍历 s 到 v 的路径。 </p>
<p><strong>深度优先只是解决了从一个顶点到另一个顶点之间是否存在一条路径的问题</strong>；</p>
<p><strong>深度优先搜索是基于栈的</strong>；</p>
<h3 id="广度优先搜索-BFS"><a href="#广度优先搜索-BFS" class="headerlink" title="广度优先搜索   BFS"></a>广度优先搜索   BFS</h3><p><strong>广度优先搜索是基于队列的</strong>；</p>
<p>使用一个队列来保存所有已经被标记过但其邻接表还未被检查过的顶点；</p>
<p>先将起点加入队列，然后从队列中将起点删除，并将相邻顶点加入队列中，然后执行下面步骤：</p>
<ol>
<li>取队列的下一个顶点 v 并标记它；</li>
<li>将与 v 相邻的所有未标记过的顶点加入队列；</li>
</ol>
<p>重复上述步骤直到队列为空；</p>
<p>JAVA 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BreadthFirstPaths</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> INFINITY = Integer.MAX_VALUE;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] marked;  <span class="comment">// marked[v] = is there an s-v path</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] edgeTo;      <span class="comment">// edgeTo[v] = previous edge on shortest s-v path</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] distTo;      <span class="comment">// distTo[v] = number of edges shortest s-v path</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes the shortest path between the source vertex &#123;<span class="doctag">@code</span> s&#125;</div><div class="line">     * and every other vertex in the graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@param</span> G the graph</div><div class="line">     * <span class="doctag">@param</span> s the source vertex</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BreadthFirstPaths</span><span class="params">(Graph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        distTo = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        edgeTo = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        validateVertex(s);</div><div class="line">        bfs(G, s);</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">check</span><span class="params">(G, s)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes the shortest path between any one of the source vertices in &#123;<span class="doctag">@code</span> sources&#125;</div><div class="line">     * and every other vertex in graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@param</span> G the graph</div><div class="line">     * <span class="doctag">@param</span> sources the source vertices</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125; for each vertex</div><div class="line">     *         &#123;<span class="doctag">@code</span> s&#125; in &#123;<span class="doctag">@code</span> sources&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BreadthFirstPaths</span><span class="params">(Graph G, Iterable&lt;Integer&gt; sources)</span> </span>&#123;</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        distTo = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        edgeTo = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            distTo[v] = INFINITY;</div><div class="line">        validateVertices(sources);</div><div class="line">        bfs(G, sources);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// breadth-first search from a single source</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">bfs</span><span class="params">(Graph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        Queue&lt;Integer&gt; q = <span class="keyword">new</span> Queue&lt;Integer&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            distTo[v] = INFINITY;</div><div class="line">        distTo[s] = <span class="number">0</span>;</div><div class="line">        marked[s] = <span class="keyword">true</span>;</div><div class="line">        q.enqueue(s);</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (!q.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> v = q.dequeue();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">                <span class="keyword">if</span> (!marked[w]) &#123;</div><div class="line">                    edgeTo[w] = v;</div><div class="line">                    distTo[w] = distTo[v] + <span class="number">1</span>;</div><div class="line">                    marked[w] = <span class="keyword">true</span>;</div><div class="line">                    q.enqueue(w);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// breadth-first search from multiple sources</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">bfs</span><span class="params">(Graph G, Iterable&lt;Integer&gt; sources)</span> </span>&#123;</div><div class="line">        Queue&lt;Integer&gt; q = <span class="keyword">new</span> Queue&lt;Integer&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> s : sources) &#123;</div><div class="line">            marked[s] = <span class="keyword">true</span>;</div><div class="line">            distTo[s] = <span class="number">0</span>;</div><div class="line">            q.enqueue(s);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (!q.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> v = q.dequeue();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">                <span class="keyword">if</span> (!marked[w]) &#123;</div><div class="line">                    edgeTo[w] = v;</div><div class="line">                    distTo[w] = distTo[v] + <span class="number">1</span>;</div><div class="line">                    marked[w] = <span class="keyword">true</span>;</div><div class="line">                    q.enqueue(w);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is there a path between the source vertex &#123;<span class="doctag">@code</span> s&#125; (or sources) and vertex &#123;<span class="doctag">@code</span> v&#125;?</div><div class="line">     * <span class="doctag">@param</span> v the vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a path, and &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> marked[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of edges in a shortest path between the source vertex &#123;<span class="doctag">@code</span> s&#125;</div><div class="line">     * (or sources) and vertex &#123;<span class="doctag">@code</span> v&#125;?</div><div class="line">     * <span class="doctag">@param</span> v the vertex</div><div class="line">     * <span class="doctag">@return</span> the number of edges in a shortest path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">distTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> distTo[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a shortest path between the source vertex &#123;<span class="doctag">@code</span> s&#125; (or sources)</div><div class="line">     * and &#123;<span class="doctag">@code</span> v&#125;, or &#123;<span class="doctag">@code</span> null&#125; if no such path.</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the sequence of vertices on a shortest path, as an Iterable</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Integer&gt; <span class="title">pathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">if</span> (!hasPathTo(v)) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        Stack&lt;Integer&gt; path = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">        <span class="keyword">int</span> x;</div><div class="line">        <span class="keyword">for</span> (x = v; distTo[x] != <span class="number">0</span>; x = edgeTo[x])</div><div class="line">            path.push(x);</div><div class="line">        path.push(x);</div><div class="line">        <span class="keyword">return</span> path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// check optimality conditions for single source</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(Graph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// check that the distance of s = 0</span></div><div class="line">        <span class="keyword">if</span> (distTo[s] != <span class="number">0</span>) &#123;</div><div class="line">            StdOut.println(<span class="string">"distance of source "</span> + s + <span class="string">" to itself = "</span> + distTo[s]);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that for each edge v-w dist[w] &lt;= dist[v] + 1</span></div><div class="line">        <span class="comment">// provided v is reachable from s</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">                <span class="keyword">if</span> (hasPathTo(v) != hasPathTo(w)) &#123;</div><div class="line">                    StdOut.println(<span class="string">"edge "</span> + v + <span class="string">"-"</span> + w);</div><div class="line">                    StdOut.println(<span class="string">"hasPathTo("</span> + v + <span class="string">") = "</span> + hasPathTo(v));</div><div class="line">                    StdOut.println(<span class="string">"hasPathTo("</span> + w + <span class="string">") = "</span> + hasPathTo(w));</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (hasPathTo(v) &amp;&amp; (distTo[w] &gt; distTo[v] + <span class="number">1</span>)) &#123;</div><div class="line">                    StdOut.println(<span class="string">"edge "</span> + v + <span class="string">"-"</span> + w);</div><div class="line">                    StdOut.println(<span class="string">"distTo["</span> + v + <span class="string">"] = "</span> + distTo[v]);</div><div class="line">                    StdOut.println(<span class="string">"distTo["</span> + w + <span class="string">"] = "</span> + distTo[w]);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that v = edgeTo[w] satisfies distTo[w] = distTo[v] + 1</span></div><div class="line">        <span class="comment">// provided v is reachable from s</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">0</span>; w &lt; G.V(); w++) &#123;</div><div class="line">            <span class="keyword">if</span> (!hasPathTo(w) || w == s) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">int</span> v = edgeTo[w];</div><div class="line">            <span class="keyword">if</span> (distTo[w] != distTo[v] + <span class="number">1</span>) &#123;</div><div class="line">                StdOut.println(<span class="string">"shortest path edge "</span> + v + <span class="string">"-"</span> + w);</div><div class="line">                StdOut.println(<span class="string">"distTo["</span> + v + <span class="string">"] = "</span> + distTo[v]);</div><div class="line">                StdOut.println(<span class="string">"distTo["</span> + w + <span class="string">"] = "</span> + distTo[w]);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = marked.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertices</span><span class="params">(Iterable&lt;Integer&gt; vertices)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (vertices == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"argument is null"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> V = marked.length;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v : vertices) &#123;</div><div class="line">            <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V) &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> BreadthFirstPaths&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        Graph G = <span class="keyword">new</span> Graph(in);</div><div class="line">        <span class="comment">// StdOut.println(G);</span></div><div class="line"></div><div class="line">        <span class="keyword">int</span> s = Integer.parseInt(args[<span class="number">1</span>]);</div><div class="line">        BreadthFirstPaths bfs = <span class="keyword">new</span> BreadthFirstPaths(G, s);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">if</span> (bfs.hasPathTo(v)) &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d (%d):  "</span>, s, v, bfs.distTo(v));</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x : bfs.pathTo(v)) &#123;</div><div class="line">                    <span class="keyword">if</span> (x == s) StdOut.print(x);</div><div class="line">                    <span class="keyword">else</span>        StdOut.print(<span class="string">"-"</span> + x);</div><div class="line">                &#125;</div><div class="line">                StdOut.println();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d (-):  not connected\n"</span>, s, v);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="连通分量"><a href="#连通分量" class="headerlink" title="连通分量"></a>连通分量</h4><p>基于深度优先搜索的解决方案如下，同样可以使用 union_find 来检查连通性；</p>
<p>java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CC</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] marked;   <span class="comment">// marked[v] = has vertex v been marked?</span></div><div class="line">    <span class="comment">//顶点 v 的连通分量</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] id;           <span class="comment">// id[v] = id of connected component containing v</span></div><div class="line">    <span class="comment">// 连通分量包含多少个顶点</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] size;         <span class="comment">// size[id] = number of vertices in given component</span></div><div class="line">    <span class="comment">//连通分量总数</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;          <span class="comment">// number of connected components</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes the connected components of the undirected graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> G the undirected graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CC</span><span class="params">(Graph G)</span> </span>&#123;</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        id = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        size = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">if</span> (!marked[v]) &#123;</div><div class="line">                dfs(G, v);</div><div class="line">                count++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes the connected components of the edge-weighted graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> G the edge-weighted graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CC</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        id = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        size = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">if</span> (!marked[v]) &#123;</div><div class="line">                dfs(G, v);</div><div class="line">                count++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// depth-first search for a Graph</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(Graph G, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        marked[v] = <span class="keyword">true</span>;</div><div class="line">        id[v] = count;</div><div class="line">        size[count]++;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">            <span class="keyword">if</span> (!marked[w]) &#123;</div><div class="line">                dfs(G, w);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// depth-first search for an EdgeWeightedGraph</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(EdgeWeightedGraph G, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        marked[v] = <span class="keyword">true</span>;</div><div class="line">        id[v] = count;</div><div class="line">        size[count]++;</div><div class="line">        <span class="keyword">for</span> (Edge e : G.adj(v)) &#123;</div><div class="line">            <span class="keyword">int</span> w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (!marked[w]) &#123;</div><div class="line">                dfs(G, w);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the component id of the connected component containing vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the component id of the connected component containing vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">id</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> id[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of vertices in the connected component containing vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the number of vertices in the connected component containing vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> size[id[v]];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of connected components in the graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of connected components in the graph &#123;<span class="doctag">@code</span> G&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> count;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns true if vertices &#123;<span class="doctag">@code</span> v&#125; and &#123;<span class="doctag">@code</span> w&#125; are in the same</div><div class="line">     * connected component.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v one vertex</div><div class="line">     * <span class="doctag">@param</span>  w the other vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if vertices &#123;<span class="doctag">@code</span> v&#125; and &#123;<span class="doctag">@code</span> w&#125; are in the same</div><div class="line">     *         connected component; &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= w &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        validateVertex(w);</div><div class="line">        <span class="keyword">return</span> id(v) == id(w);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns true if vertices &#123;<span class="doctag">@code</span> v&#125; and &#123;<span class="doctag">@code</span> w&#125; are in the same</div><div class="line">     * connected component.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v one vertex</div><div class="line">     * <span class="doctag">@param</span>  w the other vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if vertices &#123;<span class="doctag">@code</span> v&#125; and &#123;<span class="doctag">@code</span> w&#125; are in the same</div><div class="line">     *         connected component; &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= w &lt; V&#125;</div><div class="line">     * <span class="doctag">@deprecated</span> Replaced by &#123;<span class="doctag">@link</span> #connected(int, int)&#125;.</div><div class="line">     */</div><div class="line">    <span class="meta">@Deprecated</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">areConnected</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        validateVertex(w);</div><div class="line">        <span class="keyword">return</span> id(v) == id(w);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = marked.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> CC&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        Graph G = <span class="keyword">new</span> Graph(in);</div><div class="line">        CC cc = <span class="keyword">new</span> CC(G);</div><div class="line"></div><div class="line">        <span class="comment">// number of connected components</span></div><div class="line">        <span class="keyword">int</span> m = cc.count();</div><div class="line">        StdOut.println(m + <span class="string">" components"</span>);</div><div class="line"></div><div class="line">        <span class="comment">// compute list of vertices in each connected component</span></div><div class="line">        Queue&lt;Integer&gt;[] components = (Queue&lt;Integer&gt;[]) <span class="keyword">new</span> Queue[m];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            components[i] = <span class="keyword">new</span> Queue&lt;Integer&gt;();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            components[cc.id(v)].enqueue(v);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// print results</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v : components[i]) &#123;</div><div class="line">                StdOut.print(v + <span class="string">" "</span>);</div><div class="line">            &#125;</div><div class="line">            StdOut.println();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="检测环"><a href="#检测环" class="headerlink" title="检测环"></a>检测环</h4><p>给定的图是不是无环图？</p>
<p>java 实现如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cycle</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] marked;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] edgeTo;</div><div class="line">    <span class="keyword">private</span> Stack&lt;Integer&gt; cycle;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Determines whether the undirected graph &#123;<span class="doctag">@code</span> G&#125; has a cycle and,</div><div class="line">     * if so, finds such a cycle.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> G the undirected graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Cycle</span><span class="params">(Graph G)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (hasSelfLoop(G)) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span> (hasParallelEdges(G)) <span class="keyword">return</span>;</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        edgeTo = <span class="keyword">new</span> <span class="keyword">int</span>[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            <span class="keyword">if</span> (!marked[v])</div><div class="line">                dfs(G, -<span class="number">1</span>, v);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// does this graph have a self loop?</span></div><div class="line">    <span class="comment">// side effect: initialize cycle to be self loop</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">hasSelfLoop</span><span class="params">(Graph G)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">                <span class="keyword">if</span> (v == w) &#123;</div><div class="line">                    cycle = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">                    cycle.push(v);</div><div class="line">                    cycle.push(v);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// does this graph have two parallel edges?</span></div><div class="line">    <span class="comment">// side effect: initialize cycle to be two parallel edges</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">hasParallelEdges</span><span class="params">(Graph G)</span> </span>&#123;</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line"></div><div class="line">            <span class="comment">// check for parallel edges incident to v</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">                <span class="keyword">if</span> (marked[w]) &#123;</div><div class="line">                    cycle = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">                    cycle.push(v);</div><div class="line">                    cycle.push(w);</div><div class="line">                    cycle.push(v);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                marked[w] = <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// reset so marked[v] = false for all v</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line">                marked[w] = <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns true if the graph &#123;<span class="doctag">@code</span> G&#125; has a cycle.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if the graph has a cycle; &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasCycle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> cycle != <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">     <span class="comment">/**</span></div><div class="line">     * Returns a cycle in the graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@return</span> a cycle if the graph &#123;<span class="doctag">@code</span> G&#125; has a cycle,</div><div class="line">     *         and &#123;<span class="doctag">@code</span> null&#125; otherwise</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Integer&gt; <span class="title">cycle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> cycle;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(Graph G, <span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        marked[v] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w : G.adj(v)) &#123;</div><div class="line"></div><div class="line">            <span class="comment">// short circuit if cycle already found</span></div><div class="line">            <span class="keyword">if</span> (cycle != <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (!marked[w]) &#123;</div><div class="line">                edgeTo[w] = v;</div><div class="line">                dfs(G, v, w);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// check for cycle (but disregard reverse of edge leading to v)</span></div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (w != u) &#123;</div><div class="line">                cycle = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x = v; x != w; x = edgeTo[x]) &#123;</div><div class="line">                    cycle.push(x);</div><div class="line">                &#125;</div><div class="line">                cycle.push(w);</div><div class="line">                cycle.push(v);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> Cycle&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        Graph G = <span class="keyword">new</span> Graph(in);</div><div class="line">        Cycle finder = <span class="keyword">new</span> Cycle(G);</div><div class="line">        <span class="keyword">if</span> (finder.hasCycle()) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v : finder.cycle()) &#123;</div><div class="line">                StdOut.print(v + <span class="string">" "</span>);</div><div class="line">            &#125;</div><div class="line">            StdOut.println();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            StdOut.println(<span class="string">"Graph is acyclic"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="有向图"><a href="#有向图" class="headerlink" title="有向图"></a>有向图</h3><h3 id="最小生成树"><a href="#最小生成树" class="headerlink" title="最小生成树"></a>最小生成树</h3><h4 id="加权图"><a href="#加权图" class="headerlink" title="加权图"></a>加权图</h4><p>定义：一种为每条边关联一个权值或者是成本的模型；</p>
<h4 id="最小生成树-1"><a href="#最小生成树-1" class="headerlink" title="最小生成树"></a>最小生成树</h4><p>定义：图的生成树是它的一棵含有其所有顶点的无环连通子图。一幅加权图的最小生成树(MST) 是它的一棵权值（树中所有边的权值之和）最小的生成树；</p>
<h4 id="切分定理"><a href="#切分定理" class="headerlink" title="切分定理"></a>切分定理</h4><p>切分定义：图的一种切分是将图的所有顶点分为两个非空且不重叠的两个集合。横切边是一条连接两个属于不同集合的顶点的边；</p>
<p>切分定理：在一幅加权图中，给定任意的切分，它的横切边中的权重最小者必然属于图的最小生成树；</p>
<h4 id="贪心算法"><a href="#贪心算法" class="headerlink" title="贪心算法"></a>贪心算法</h4><p>定义：下面这种方法会将含有 V 个顶点的任意加权连通图中属于最小生成树的边标记为黑色：初始状态下所有边均为灰色， 找到一种切分，它产生的横切边均不为黑色。将它权重最小的横切边标记为黑色。反复，直到标记了V - 1条黑色边为止；</p>
<h4 id="加权无向图"><a href="#加权无向图" class="headerlink" title="加权无向图"></a>加权无向图</h4><p>在邻接表中，在链表的结点中增加一个权重域；</p>
<p>Edge 的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Edge</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Edge</span>&gt; </span>&#123; </div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> v;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> w;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> weight;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an edge between vertices &#123;<span class="doctag">@code</span> v&#125; and &#123;<span class="doctag">@code</span> w&#125; of</div><div class="line">     * the given &#123;<span class="doctag">@code</span> weight&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v one vertex</div><div class="line">     * <span class="doctag">@param</span>  w the other vertex</div><div class="line">     * <span class="doctag">@param</span>  weight the weight of this edge</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if either &#123;<span class="doctag">@code</span> v&#125; or &#123;<span class="doctag">@code</span> w&#125; </div><div class="line">     *         is a negative integer</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> weight&#125; is &#123;<span class="doctag">@code</span> NaN&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Edge</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> w, <span class="keyword">double</span> weight)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex index must be a nonnegative integer"</span>);</div><div class="line">        <span class="keyword">if</span> (w &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex index must be a nonnegative integer"</span>);</div><div class="line">        <span class="keyword">if</span> (Double.isNaN(weight)) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Weight is NaN"</span>);</div><div class="line">        <span class="keyword">this</span>.v = v;</div><div class="line">        <span class="keyword">this</span>.w = w;</div><div class="line">        <span class="keyword">this</span>.weight = weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the weight of this edge.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the weight of this edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns either endpoint of this edge.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> either endpoint of this edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">either</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the endpoint of this edge that is different from the given vertex.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  vertex one endpoint of this edge</div><div class="line">     * <span class="doctag">@return</span> the other endpoint of this edge</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if the vertex is not one of the</div><div class="line">     *         endpoints of this edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">other</span><span class="params">(<span class="keyword">int</span> vertex)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>      (vertex == v) <span class="keyword">return</span> w;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (vertex == w) <span class="keyword">return</span> v;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal endpoint"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Compares two edges by weight.</div><div class="line">     * Note that &#123;<span class="doctag">@code</span> compareTo()&#125; is not consistent with &#123;<span class="doctag">@code</span> equals()&#125;,</div><div class="line">     * which uses the reference equality implementation inherited from &#123;<span class="doctag">@code</span> Object&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  that the other edge</div><div class="line">     * <span class="doctag">@return</span> a negative integer, zero, or positive integer depending on whether</div><div class="line">     *         the weight of this is less than, equal to, or greater than the</div><div class="line">     *         argument edge</div><div class="line">     */</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Edge that)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Double.compare(<span class="keyword">this</span>.weight, that.weight);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a string representation of this edge.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> a string representation of this edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> String.format(<span class="string">"%d-%d %.5f"</span>, v, w, weight);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> Edge&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Edge e = <span class="keyword">new</span> Edge(<span class="number">12</span>, <span class="number">34</span>, <span class="number">5.67</span>);</div><div class="line">        StdOut.println(e);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>EdgeWeightedGraph 的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EdgeWeightedGraph</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String NEWLINE = System.getProperty(<span class="string">"line.separator"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> V;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> E;</div><div class="line">    <span class="keyword">private</span> Bag&lt;Edge&gt;[] adj;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty edge-weighted graph with &#123;<span class="doctag">@code</span> V&#125; vertices and 0 edges.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  V the number of vertices</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> V &lt; 0&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedGraph</span><span class="params">(<span class="keyword">int</span> V)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (V &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of vertices must be nonnegative"</span>);</div><div class="line">        <span class="keyword">this</span>.V = V;</div><div class="line">        <span class="keyword">this</span>.E = <span class="number">0</span>;</div><div class="line">        adj = (Bag&lt;Edge&gt;[]) <span class="keyword">new</span> Bag[V];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            adj[v] = <span class="keyword">new</span> Bag&lt;Edge&gt;();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a random edge-weighted graph with &#123;<span class="doctag">@code</span> V&#125; vertices and &lt;em&gt;E&lt;/em&gt; edges.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  V the number of vertices</div><div class="line">     * <span class="doctag">@param</span>  E the number of edges</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> V &lt; 0&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> E &lt; 0&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedGraph</span><span class="params">(<span class="keyword">int</span> V, <span class="keyword">int</span> E)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(V);</div><div class="line">        <span class="keyword">if</span> (E &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of edges must be nonnegative"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; i++) &#123;</div><div class="line">            <span class="keyword">int</span> v = StdRandom.uniform(V);</div><div class="line">            <span class="keyword">int</span> w = StdRandom.uniform(V);</div><div class="line">            <span class="keyword">double</span> weight = Math.round(<span class="number">100</span> * StdRandom.uniform()) / <span class="number">100.0</span>;</div><div class="line">            Edge e = <span class="keyword">new</span> Edge(v, w, weight);</div><div class="line">            addEdge(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**  </span></div><div class="line">     * Initializes an edge-weighted graph from an input stream.</div><div class="line">     * The format is the number of vertices &lt;em&gt;V&lt;/em&gt;,</div><div class="line">     * followed by the number of edges &lt;em&gt;E&lt;/em&gt;,</div><div class="line">     * followed by &lt;em&gt;E&lt;/em&gt; pairs of vertices and edge weights,</div><div class="line">     * with each entry separated by whitespace.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  in the input stream</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if the endpoints of any edge are not in prescribed range</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if the number of vertices or edges is negative</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedGraph</span><span class="params">(In in)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(in.readInt());</div><div class="line">        <span class="keyword">int</span> E = in.readInt();</div><div class="line">        <span class="keyword">if</span> (E &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of edges must be nonnegative"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; i++) &#123;</div><div class="line">            <span class="keyword">int</span> v = in.readInt();</div><div class="line">            <span class="keyword">int</span> w = in.readInt();</div><div class="line">            validateVertex(v);</div><div class="line">            validateVertex(w);</div><div class="line">            <span class="keyword">double</span> weight = in.readDouble();</div><div class="line">            Edge e = <span class="keyword">new</span> Edge(v, w, weight);</div><div class="line">            addEdge(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a new edge-weighted graph that is a deep copy of &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  G the edge-weighted graph to copy</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedGraph</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(G.V());</div><div class="line">        <span class="keyword">this</span>.E = G.E();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="comment">// reverse so that adjacency list is in same order as original</span></div><div class="line">            Stack&lt;Edge&gt; reverse = <span class="keyword">new</span> Stack&lt;Edge&gt;();</div><div class="line">            <span class="keyword">for</span> (Edge e : G.adj[v]) &#123;</div><div class="line">                reverse.push(e);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (Edge e : reverse) &#123;</div><div class="line">                adj[v].add(e);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of vertices in this edge-weighted graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of vertices in this edge-weighted graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">V</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> V;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of edges in this edge-weighted graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of edges in this edge-weighted graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">E</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> E;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Adds the undirected edge &#123;<span class="doctag">@code</span> e&#125; to this edge-weighted graph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  e the edge</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless both endpoints are between &#123;<span class="doctag">@code</span> 0&#125; and &#123;<span class="doctag">@code</span> V-1&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(Edge e)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> v = e.either();</div><div class="line">        <span class="keyword">int</span> w = e.other(v);</div><div class="line">        validateVertex(v);</div><div class="line">        validateVertex(w);</div><div class="line">        adj[v].add(e);</div><div class="line">        adj[w].add(e);</div><div class="line">        E++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the edges incident on vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the edges incident on vertex &#123;<span class="doctag">@code</span> v&#125; as an Iterable</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Edge&gt; <span class="title">adj</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> adj[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the degree of vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the degree of vertex &#123;<span class="doctag">@code</span> v&#125;               </div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">degree</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> adj[v].size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns all edges in this edge-weighted graph.</div><div class="line">     * To iterate over the edges in this edge-weighted graph, use foreach notation:</div><div class="line">     * &#123;<span class="doctag">@code</span> for (Edge e : G.edges())&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> all edges in this edge-weighted graph, as an iterable</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Edge&gt; <span class="title">edges</span><span class="params">()</span> </span>&#123;</div><div class="line">        Bag&lt;Edge&gt; list = <span class="keyword">new</span> Bag&lt;Edge&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            <span class="keyword">int</span> selfLoops = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (Edge e : adj(v)) &#123;</div><div class="line">                <span class="keyword">if</span> (e.other(v) &gt; v) &#123;</div><div class="line">                    list.add(e);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// add only one copy of each self loop (self loops will be consecutive)</span></div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e.other(v) == v) &#123;</div><div class="line">                    <span class="keyword">if</span> (selfLoops % <span class="number">2</span> == <span class="number">0</span>) list.add(e);</div><div class="line">                    selfLoops++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a string representation of the edge-weighted graph.</div><div class="line">     * This method takes time proportional to &lt;em&gt;E&lt;/em&gt; + &lt;em&gt;V&lt;/em&gt;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of vertices &lt;em&gt;V&lt;/em&gt;, followed by the number of edges &lt;em&gt;E&lt;/em&gt;,</div><div class="line">     *         followed by the &lt;em&gt;V&lt;/em&gt; adjacency lists of edges</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder s = <span class="keyword">new</span> StringBuilder();</div><div class="line">        s.append(V + <span class="string">" "</span> + E + NEWLINE);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            s.append(v + <span class="string">": "</span>);</div><div class="line">            <span class="keyword">for</span> (Edge e : adj[v]) &#123;</div><div class="line">                s.append(e + <span class="string">"  "</span>);</div><div class="line">            &#125;</div><div class="line">            s.append(NEWLINE);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> s.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> EdgeWeightedGraph&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        EdgeWeightedGraph G = <span class="keyword">new</span> EdgeWeightedGraph(in);</div><div class="line">        StdOut.println(G);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Prim-算法"><a href="#Prim-算法" class="headerlink" title="Prim 算法"></a>Prim 算法</h4><p>命题：<strong>Prim 算法能够得到任意加权连通图的最小生成树；</strong></p>
<p>从一棵树的顶点开始，每次总是将下一条连接树的顶点与它的横切边加入树中；</p>
<h5 id="Lazy-Prim-延时实现"><a href="#Lazy-Prim-延时实现" class="headerlink" title="Lazy Prim 延时实现"></a>Lazy Prim 延时实现</h5><ul>
<li>一条优先队列保存所有的横切边， 将失效的边保留在队列中；</li>
<li>一个由顶点索引的数组来标记树的顶点；</li>
<li>一条队列来保存最小生成树的边；</li>
</ul>
<p>Java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazyPrimMST</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> FLOATING_POINT_EPSILON = <span class="number">1E-12</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> weight;       <span class="comment">// total weight of MST</span></div><div class="line">    <span class="comment">//最小生成树的边</span></div><div class="line">    <span class="keyword">private</span> Queue&lt;Edge&gt; mst;     <span class="comment">// edges in the MST</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] marked;    <span class="comment">// marked[v] = true if v on tree</span></div><div class="line">    <span class="comment">//包含所有的横切边</span></div><div class="line">    <span class="keyword">private</span> MinPQ&lt;Edge&gt; pq;      <span class="comment">// edges with one endpoint in tree</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Compute a minimum spanning tree (or forest) of an edge-weighted graph.</div><div class="line">     * <span class="doctag">@param</span> G the edge-weighted graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LazyPrimMST</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line">        mst = <span class="keyword">new</span> Queue&lt;Edge&gt;();</div><div class="line">        pq = <span class="keyword">new</span> MinPQ&lt;Edge&gt;();</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)     <span class="comment">// run Prim from all vertices to</span></div><div class="line">            <span class="keyword">if</span> (!marked[v]) prim(G, v);     <span class="comment">// get a minimum spanning forest</span></div><div class="line"></div><div class="line">        <span class="comment">// check optimality conditions</span></div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">check</span><span class="params">(G)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// run Prim's algorithm</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">prim</span><span class="params">(EdgeWeightedGraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        scan(G, s);</div><div class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;                        <span class="comment">// better to stop when mst has V-1 edges</span></div><div class="line">            Edge e = pq.delMin();                      <span class="comment">// smallest edge on pq</span></div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);        <span class="comment">// two endpoints</span></div><div class="line">            <span class="keyword">assert</span> marked[v] || marked[w];</div><div class="line">            <span class="keyword">if</span> (marked[v] &amp;&amp; marked[w]) <span class="keyword">continue</span>;      <span class="comment">// lazy, both v and w already scanned</span></div><div class="line">            mst.enqueue(e);                            <span class="comment">// add e to MST</span></div><div class="line">            weight += e.weight();</div><div class="line">            <span class="keyword">if</span> (!marked[v]) scan(G, v);               <span class="comment">// v becomes part of tree</span></div><div class="line">            <span class="keyword">if</span> (!marked[w]) scan(G, w);               <span class="comment">// w becomes part of tree</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// add all edges e incident to v onto pq if the other endpoint has not yet been scanned</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scan</span><span class="params">(EdgeWeightedGraph G, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">assert</span> !marked[v];</div><div class="line">        marked[v] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span> (Edge e : G.adj(v))</div><div class="line">            <span class="keyword">if</span> (!marked[e.other(v)]) pq.insert(e);</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the edges in a minimum spanning tree (or forest).</div><div class="line">     * <span class="doctag">@return</span> the edges in a minimum spanning tree (or forest) as</div><div class="line">     *    an iterable of edges</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Edge&gt; <span class="title">edges</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mst;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the sum of the edge weights in a minimum spanning tree (or forest).</div><div class="line">     * <span class="doctag">@return</span> the sum of the edge weights in a minimum spanning tree (or forest)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// check optimality conditions (takes time proportional to E V lg* V)</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// check weight</span></div><div class="line">        <span class="keyword">double</span> totalWeight = <span class="number">0.0</span>;</div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line">            totalWeight += e.weight();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (Math.abs(totalWeight - weight()) &gt; FLOATING_POINT_EPSILON) &#123;</div><div class="line">            System.err.printf(<span class="string">"Weight of edges does not equal weight(): %f vs. %f\n"</span>, totalWeight, weight());</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is acyclic</span></div><div class="line">        UF uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (uf.connected(v, w)) &#123;</div><div class="line">                System.err.println(<span class="string">"Not a forest"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            uf.union(v, w);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is a spanning forest</span></div><div class="line">        <span class="keyword">for</span> (Edge e : G.edges()) &#123;</div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (!uf.connected(v, w)) &#123;</div><div class="line">                System.err.println(<span class="string">"Not a spanning forest"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is a minimal spanning forest (cut optimality conditions)</span></div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line"></div><div class="line">            <span class="comment">// all edges in MST except e</span></div><div class="line">            uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">            <span class="keyword">for</span> (Edge f : mst) &#123;</div><div class="line">                <span class="keyword">int</span> x = f.either(), y = f.other(x);</div><div class="line">                <span class="keyword">if</span> (f != e) uf.union(x, y);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// check that e is min weight edge in crossing cut</span></div><div class="line">            <span class="keyword">for</span> (Edge f : G.edges()) &#123;</div><div class="line">                <span class="keyword">int</span> x = f.either(), y = f.other(x);</div><div class="line">                <span class="keyword">if</span> (!uf.connected(x, y)) &#123;</div><div class="line">                    <span class="keyword">if</span> (f.weight() &lt; e.weight()) &#123;</div><div class="line">                        System.err.println(<span class="string">"Edge "</span> + f + <span class="string">" violates cut optimality conditions"</span>);</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> LazyPrimMST&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        EdgeWeightedGraph G = <span class="keyword">new</span> EdgeWeightedGraph(in);</div><div class="line">        LazyPrimMST mst = <span class="keyword">new</span> LazyPrimMST(G);</div><div class="line">        <span class="keyword">for</span> (Edge e : mst.edges()) &#123;</div><div class="line">            StdOut.println(e);</div><div class="line">        &#125;</div><div class="line">        StdOut.printf(<span class="string">"%.5f\n"</span>, mst.weight());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>相应的 <code>MinPQ</code> 的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MinPQ</span>&lt;<span class="title">Key</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Key</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> Key[] pq;                    <span class="comment">// store items at indices 1 to n</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n;                       <span class="comment">// number of items on priority queue</span></div><div class="line">    <span class="keyword">private</span> Comparator&lt;Key&gt; comparator;  <span class="comment">// optional comparator</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty priority queue with the given initial capacity.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  initCapacity the initial capacity of this priority queue</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinPQ</span><span class="params">(<span class="keyword">int</span> initCapacity)</span> </span>&#123;</div><div class="line">        pq = (Key[]) <span class="keyword">new</span> Object[initCapacity + <span class="number">1</span>];</div><div class="line">        n = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty priority queue.</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinPQ</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty priority queue with the given initial capacity,</div><div class="line">     * using the given comparator.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  initCapacity the initial capacity of this priority queue</div><div class="line">     * <span class="doctag">@param</span>  comparator the order in which to compare the keys</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinPQ</span><span class="params">(<span class="keyword">int</span> initCapacity, Comparator&lt;Key&gt; comparator)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.comparator = comparator;</div><div class="line">        pq = (Key[]) <span class="keyword">new</span> Object[initCapacity + <span class="number">1</span>];</div><div class="line">        n = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty priority queue using the given comparator.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  comparator the order in which to compare the keys</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinPQ</span><span class="params">(Comparator&lt;Key&gt; comparator)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(<span class="number">1</span>, comparator);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a priority queue from the array of keys.</div><div class="line">     * &lt;p&gt;</div><div class="line">     * Takes time proportional to the number of keys, using sink-based heap construction.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  keys the array of keys</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinPQ</span><span class="params">(Key[] keys)</span> </span>&#123;</div><div class="line">        n = keys.length;</div><div class="line">        pq = (Key[]) <span class="keyword">new</span> Object[keys.length + <span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            pq[i+<span class="number">1</span>] = keys[i];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = n/<span class="number">2</span>; k &gt;= <span class="number">1</span>; k--)</div><div class="line">            sink(k);</div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">isMinHeap</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns true if this priority queue is empty.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if this priority queue is empty;</div><div class="line">     *         &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> n == <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of keys on this priority queue.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of keys on this priority queue</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> n;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a smallest key on this priority queue.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> a smallest key on this priority queue</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException if this priority queue is empty</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Key <span class="title">min</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (isEmpty()) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"Priority queue underflow"</span>);</div><div class="line">        <span class="keyword">return</span> pq[<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// helper function to double the size of the heap array</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</div><div class="line">        <span class="keyword">assert</span> capacity &gt; n;</div><div class="line">        Key[] temp = (Key[]) <span class="keyword">new</span> Object[capacity];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            temp[i] = pq[i];</div><div class="line">        &#125;</div><div class="line">        pq = temp;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Adds a new key to this priority queue.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  x the key to add to this priority queue</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Key x)</span> </span>&#123;</div><div class="line">        <span class="comment">// double size of array if necessary</span></div><div class="line">        <span class="keyword">if</span> (n == pq.length - <span class="number">1</span>) resize(<span class="number">2</span> * pq.length);</div><div class="line"></div><div class="line">        <span class="comment">// add x, and percolate it up to maintain heap invariant</span></div><div class="line">        pq[++n] = x;</div><div class="line">        swim(n);</div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">isMinHeap</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Removes and returns a smallest key on this priority queue.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> a smallest key on this priority queue</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException if this priority queue is empty</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Key <span class="title">delMin</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (isEmpty()) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"Priority queue underflow"</span>);</div><div class="line">        Key min = pq[<span class="number">1</span>];</div><div class="line">        exch(<span class="number">1</span>, n--);</div><div class="line">        sink(<span class="number">1</span>);</div><div class="line">        pq[n+<span class="number">1</span>] = <span class="keyword">null</span>;     <span class="comment">// to avoid loiterig and help with garbage collection</span></div><div class="line">        <span class="keyword">if</span> ((n &gt; <span class="number">0</span>) &amp;&amp; (n == (pq.length - <span class="number">1</span>) / <span class="number">4</span>)) resize(pq.length / <span class="number">2</span>);</div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">isMinHeap</span><span class="params">()</span></span>;</div><div class="line">        <span class="keyword">return</span> min;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">/***************************************************************************</span></div><div class="line">    * Helper functions to restore the heap invariant.</div><div class="line">    ***************************************************************************/</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; greater(k/<span class="number">2</span>, k)) &#123;</div><div class="line">            exch(k, k/<span class="number">2</span>);</div><div class="line">            k = k/<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sink</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (<span class="number">2</span>*k &lt;= n) &#123;</div><div class="line">            <span class="keyword">int</span> j = <span class="number">2</span>*k;</div><div class="line">            <span class="keyword">if</span> (j &lt; n &amp;&amp; greater(j, j+<span class="number">1</span>)) j++;</div><div class="line">            <span class="keyword">if</span> (!greater(k, j)) <span class="keyword">break</span>;</div><div class="line">            exch(k, j);</div><div class="line">            k = j;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">   <span class="comment">/***************************************************************************</span></div><div class="line">    * Helper functions for compares and swaps.</div><div class="line">    ***************************************************************************/</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">greater</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (comparator == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> ((Comparable&lt;Key&gt;) pq[i]).compareTo(pq[j]) &gt; <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> comparator.compare(pq[i], pq[j]) &gt; <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">exch</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">        Key swap = pq[i];</div><div class="line">        pq[i] = pq[j];</div><div class="line">        pq[j] = swap;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// is pq[1..N] a min heap?</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isMinHeap</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> isMinHeap(<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// is subtree of pq[1..n] rooted at k a min heap?</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isMinHeap</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (k &gt; n) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">int</span> left = <span class="number">2</span>*k;</div><div class="line">        <span class="keyword">int</span> right = <span class="number">2</span>*k + <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (left  &lt;= n &amp;&amp; greater(k, left))  <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">if</span> (right &lt;= n &amp;&amp; greater(k, right)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">return</span> isMinHeap(left) &amp;&amp; isMinHeap(right);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns an iterator that iterates over the keys on this priority queue</div><div class="line">     * in ascending order.</div><div class="line">     * &lt;p&gt;</div><div class="line">     * The iterator doesn't implement &#123;<span class="doctag">@code</span> remove()&#125; since it's optional.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> an iterator that iterates over the keys in ascending order</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Key&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HeapIterator();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Key</span>&gt; </span>&#123;</div><div class="line">        <span class="comment">// create a new pq</span></div><div class="line">        <span class="keyword">private</span> MinPQ&lt;Key&gt; copy;</div><div class="line"></div><div class="line">        <span class="comment">// add all items to copy of heap</span></div><div class="line">        <span class="comment">// takes linear time since already in heap order so no keys move</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">HeapIterator</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (comparator == <span class="keyword">null</span>) copy = <span class="keyword">new</span> MinPQ&lt;Key&gt;(size());</div><div class="line">            <span class="keyword">else</span>                    copy = <span class="keyword">new</span> MinPQ&lt;Key&gt;(size(), comparator);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">                copy.insert(pq[i]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span>  </span>&#123; <span class="keyword">return</span> !copy.isEmpty();                     &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span>      </span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();  &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Key <span class="title">next</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (!hasNext()) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</div><div class="line">            <span class="keyword">return</span> copy.delMin();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> MinPQ&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        MinPQ&lt;String&gt; pq = <span class="keyword">new</span> MinPQ&lt;String&gt;();</div><div class="line">        <span class="keyword">while</span> (!StdIn.isEmpty()) &#123;</div><div class="line">            String item = StdIn.readString();</div><div class="line">            <span class="keyword">if</span> (!item.equals(<span class="string">"-"</span>)) pq.insert(item);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (!pq.isEmpty()) StdOut.print(pq.delMin() + <span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        StdOut.println(<span class="string">"("</span> + pq.size() + <span class="string">" left on pq)"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="Prim-即时实现"><a href="#Prim-即时实现" class="headerlink" title="Prim  即时实现"></a>Prim  即时实现</h5><p>关注的是每个顶点横切边中的最小值；</p>
<p>将失效的边从队列中删除掉；</p>
<p><strong>将有效的横切边都保存在一条索引优先队列中。</strong></p>
<p>Java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrimMST</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> FLOATING_POINT_EPSILON = <span class="number">1E-12</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Edge[] edgeTo;        <span class="comment">// edgeTo[v] = shortest edge from tree vertex to non-tree vertex</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] distTo;      <span class="comment">// distTo[v] = weight of shortest such edge</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] marked;     <span class="comment">// marked[v] = true if v on tree, false otherwise</span></div><div class="line">    <span class="keyword">private</span> IndexMinPQ&lt;Double&gt; pq;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Compute a minimum spanning tree (or forest) of an edge-weighted graph.</div><div class="line">     * <span class="doctag">@param</span> G the edge-weighted graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrimMST</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line">        edgeTo = <span class="keyword">new</span> Edge[G.V()];</div><div class="line">        distTo = <span class="keyword">new</span> <span class="keyword">double</span>[G.V()];</div><div class="line">        marked = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        pq = <span class="keyword">new</span> IndexMinPQ&lt;Double&gt;(G.V());</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            distTo[v] = Double.POSITIVE_INFINITY;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)      <span class="comment">// run from each vertex to find</span></div><div class="line">            <span class="keyword">if</span> (!marked[v]) prim(G, v);      <span class="comment">// minimum spanning forest</span></div><div class="line"></div><div class="line">        <span class="comment">// check optimality conditions</span></div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">check</span><span class="params">(G)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// run Prim's algorithm in graph G, starting from vertex s</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">prim</span><span class="params">(EdgeWeightedGraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        distTo[s] = <span class="number">0.0</span>;</div><div class="line">        pq.insert(s, distTo[s]);</div><div class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> v = pq.delMin();</div><div class="line">            scan(G, v);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// scan vertex v</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scan</span><span class="params">(EdgeWeightedGraph G, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        marked[v] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span> (Edge e : G.adj(v)) &#123;</div><div class="line">            <span class="keyword">int</span> w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (marked[w]) <span class="keyword">continue</span>;         <span class="comment">// v-w is obsolete edge</span></div><div class="line">            <span class="keyword">if</span> (e.weight() &lt; distTo[w]) &#123;</div><div class="line">                distTo[w] = e.weight();</div><div class="line">                edgeTo[w] = e;</div><div class="line">                <span class="keyword">if</span> (pq.contains(w)) pq.decreaseKey(w, distTo[w]);</div><div class="line">                <span class="keyword">else</span>                pq.insert(w, distTo[w]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the edges in a minimum spanning tree (or forest).</div><div class="line">     * <span class="doctag">@return</span> the edges in a minimum spanning tree (or forest) as</div><div class="line">     *    an iterable of edges</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Edge&gt; <span class="title">edges</span><span class="params">()</span> </span>&#123;</div><div class="line">        Queue&lt;Edge&gt; mst = <span class="keyword">new</span> Queue&lt;Edge&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; edgeTo.length; v++) &#123;</div><div class="line">            Edge e = edgeTo[v];</div><div class="line">            <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;</div><div class="line">                mst.enqueue(e);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> mst;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the sum of the edge weights in a minimum spanning tree (or forest).</div><div class="line">     * <span class="doctag">@return</span> the sum of the edge weights in a minimum spanning tree (or forest)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">double</span> weight = <span class="number">0.0</span>;</div><div class="line">        <span class="keyword">for</span> (Edge e : edges())</div><div class="line">            weight += e.weight();</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// check optimality conditions (takes time proportional to E V lg* V)</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// check weight</span></div><div class="line">        <span class="keyword">double</span> totalWeight = <span class="number">0.0</span>;</div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line">            totalWeight += e.weight();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (Math.abs(totalWeight - weight()) &gt; FLOATING_POINT_EPSILON) &#123;</div><div class="line">            System.err.printf(<span class="string">"Weight of edges does not equal weight(): %f vs. %f\n"</span>, totalWeight, weight());</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is acyclic</span></div><div class="line">        UF uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (uf.connected(v, w)) &#123;</div><div class="line">                System.err.println(<span class="string">"Not a forest"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            uf.union(v, w);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is a spanning forest</span></div><div class="line">        <span class="keyword">for</span> (Edge e : G.edges()) &#123;</div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (!uf.connected(v, w)) &#123;</div><div class="line">                System.err.println(<span class="string">"Not a spanning forest"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is a minimal spanning forest (cut optimality conditions)</span></div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line"></div><div class="line">            <span class="comment">// all edges in MST except e</span></div><div class="line">            uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">            <span class="keyword">for</span> (Edge f : edges()) &#123;</div><div class="line">                <span class="keyword">int</span> x = f.either(), y = f.other(x);</div><div class="line">                <span class="keyword">if</span> (f != e) uf.union(x, y);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// check that e is min weight edge in crossing cut</span></div><div class="line">            <span class="keyword">for</span> (Edge f : G.edges()) &#123;</div><div class="line">                <span class="keyword">int</span> x = f.either(), y = f.other(x);</div><div class="line">                <span class="keyword">if</span> (!uf.connected(x, y)) &#123;</div><div class="line">                    <span class="keyword">if</span> (f.weight() &lt; e.weight()) &#123;</div><div class="line">                        System.err.println(<span class="string">"Edge "</span> + f + <span class="string">" violates cut optimality conditions"</span>);</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> PrimMST&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        EdgeWeightedGraph G = <span class="keyword">new</span> EdgeWeightedGraph(in);</div><div class="line">        PrimMST mst = <span class="keyword">new</span> PrimMST(G);</div><div class="line">        <span class="keyword">for</span> (Edge e : mst.edges()) &#123;</div><div class="line">            StdOut.println(e);</div><div class="line">        &#125;</div><div class="line">        StdOut.printf(<span class="string">"%.5f\n"</span>, mst.weight());</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>相应的 <code>IndexMinPQ</code> 算法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexMinPQ</span>&lt;<span class="title">Key</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Key</span>&gt;&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxN;        <span class="comment">// maximum number of elements on PQ</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n;           <span class="comment">// number of elements on PQ</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] pq;        <span class="comment">// binary heap using 1-based indexing</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] qp;        <span class="comment">// inverse of pq - qp[pq[i]] = pq[qp[i]] = i</span></div><div class="line">    <span class="keyword">private</span> Key[] keys;      <span class="comment">// keys[i] = priority of i</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty indexed priority queue with indices between &#123;<span class="doctag">@code</span> 0&#125;</div><div class="line">     * and &#123;<span class="doctag">@code</span> maxN - 1&#125;.</div><div class="line">     * <span class="doctag">@param</span>  maxN the keys on this priority queue are index from &#123;<span class="doctag">@code</span> 0&#125;</div><div class="line">     *         &#123;<span class="doctag">@code</span> maxN - 1&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> maxN &lt; 0&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IndexMinPQ</span><span class="params">(<span class="keyword">int</span> maxN)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (maxN &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">this</span>.maxN = maxN;</div><div class="line">        n = <span class="number">0</span>;</div><div class="line">        keys = (Key[]) <span class="keyword">new</span> Comparable[maxN + <span class="number">1</span>];    <span class="comment">// make this of length maxN??</span></div><div class="line">        pq   = <span class="keyword">new</span> <span class="keyword">int</span>[maxN + <span class="number">1</span>];</div><div class="line">        qp   = <span class="keyword">new</span> <span class="keyword">int</span>[maxN + <span class="number">1</span>];                   <span class="comment">// make this of length maxN??</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxN; i++)</div><div class="line">            qp[i] = -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns true if this priority queue is empty.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if this priority queue is empty;</div><div class="line">     *         &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> n == <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is &#123;<span class="doctag">@code</span> i&#125; an index on this priority queue?</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i an index</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if &#123;<span class="doctag">@code</span> i&#125; is an index on this priority queue;</div><div class="line">     *         &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">return</span> qp[i] != -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of keys on this priority queue.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of keys on this priority queue</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> n;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Associates key with index &#123;<span class="doctag">@code</span> i&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i an index</div><div class="line">     * <span class="doctag">@param</span>  key the key to associate with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if there already is an item associated</div><div class="line">     *         with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> i, Key key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">if</span> (contains(i)) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"index is already in the priority queue"</span>);</div><div class="line">        n++;</div><div class="line">        qp[i] = n;</div><div class="line">        pq[n] = i;</div><div class="line">        keys[i] = key;</div><div class="line">        swim(n);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns an index associated with a minimum key.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> an index associated with a minimum key</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException if this priority queue is empty</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minIndex</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"Priority queue underflow"</span>);</div><div class="line">        <span class="keyword">return</span> pq[<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a minimum key.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> a minimum key</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException if this priority queue is empty</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Key <span class="title">minKey</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"Priority queue underflow"</span>);</div><div class="line">        <span class="keyword">return</span> keys[pq[<span class="number">1</span>]];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Removes a minimum key and returns its associated index.</div><div class="line">     * <span class="doctag">@return</span> an index associated with a minimum key</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException if this priority queue is empty</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delMin</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"Priority queue underflow"</span>);</div><div class="line">        <span class="keyword">int</span> min = pq[<span class="number">1</span>];</div><div class="line">        exch(<span class="number">1</span>, n--);</div><div class="line">        sink(<span class="number">1</span>);</div><div class="line">        <span class="keyword">assert</span> min == pq[n+<span class="number">1</span>];</div><div class="line">        qp[min] = -<span class="number">1</span>;        <span class="comment">// delete</span></div><div class="line">        keys[min] = <span class="keyword">null</span>;    <span class="comment">// to help with garbage collection</span></div><div class="line">        pq[n+<span class="number">1</span>] = -<span class="number">1</span>;        <span class="comment">// not needed</span></div><div class="line">        <span class="keyword">return</span> min;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the key associated with index &#123;<span class="doctag">@code</span> i&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i the index of the key to return</div><div class="line">     * <span class="doctag">@return</span> the key associated with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException no key is associated with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Key <span class="title">keyOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">if</span> (!contains(i)) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"index is not in the priority queue"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> keys[i];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Change the key associated with index &#123;<span class="doctag">@code</span> i&#125; to the specified value.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i the index of the key to change</div><div class="line">     * <span class="doctag">@param</span>  key change the key associated with index &#123;<span class="doctag">@code</span> i&#125; to this key</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException no key is associated with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changeKey</span><span class="params">(<span class="keyword">int</span> i, Key key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">if</span> (!contains(i)) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"index is not in the priority queue"</span>);</div><div class="line">        keys[i] = key;</div><div class="line">        swim(qp[i]);</div><div class="line">        sink(qp[i]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Change the key associated with index &#123;<span class="doctag">@code</span> i&#125; to the specified value.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i the index of the key to change</div><div class="line">     * <span class="doctag">@param</span>  key change the key associated with index &#123;<span class="doctag">@code</span> i&#125; to this key</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@deprecated</span> Replaced by &#123;<span class="doctag">@code</span> changeKey(int, Key)&#125;.</div><div class="line">     */</div><div class="line">    <span class="meta">@Deprecated</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> i, Key key)</span> </span>&#123;</div><div class="line">        changeKey(i, key);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Decrease the key associated with index &#123;<span class="doctag">@code</span> i&#125; to the specified value.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i the index of the key to decrease</div><div class="line">     * <span class="doctag">@param</span>  key decrease the key associated with index &#123;<span class="doctag">@code</span> i&#125; to this key</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> key &gt;= keyOf(i)&#125;</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException no key is associated with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">decreaseKey</span><span class="params">(<span class="keyword">int</span> i, Key key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">if</span> (!contains(i)) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"index is not in the priority queue"</span>);</div><div class="line">        <span class="keyword">if</span> (keys[i].compareTo(key) &lt;= <span class="number">0</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Calling decreaseKey() with given argument would not strictly decrease the key"</span>);</div><div class="line">        keys[i] = key;</div><div class="line">        swim(qp[i]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Increase the key associated with index &#123;<span class="doctag">@code</span> i&#125; to the specified value.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i the index of the key to increase</div><div class="line">     * <span class="doctag">@param</span>  key increase the key associated with index &#123;<span class="doctag">@code</span> i&#125; to this key</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> key &lt;= keyOf(i)&#125;</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException no key is associated with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">increaseKey</span><span class="params">(<span class="keyword">int</span> i, Key key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">if</span> (!contains(i)) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"index is not in the priority queue"</span>);</div><div class="line">        <span class="keyword">if</span> (keys[i].compareTo(key) &gt;= <span class="number">0</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Calling increaseKey() with given argument would not strictly increase the key"</span>);</div><div class="line">        keys[i] = key;</div><div class="line">        sink(qp[i]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Remove the key associated with index &#123;<span class="doctag">@code</span> i&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  i the index of the key to remove</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= i &lt; maxN&#125;</div><div class="line">     * <span class="doctag">@throws</span> NoSuchElementException no key is associated with index &#123;<span class="doctag">@code</span> i&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= maxN) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">        <span class="keyword">if</span> (!contains(i)) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"index is not in the priority queue"</span>);</div><div class="line">        <span class="keyword">int</span> index = qp[i];</div><div class="line">        exch(index, n--);</div><div class="line">        swim(index);</div><div class="line">        sink(index);</div><div class="line">        keys[i] = <span class="keyword">null</span>;</div><div class="line">        qp[i] = -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">/***************************************************************************</span></div><div class="line">    * General helper functions.</div><div class="line">    ***************************************************************************/</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">greater</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> keys[pq[i]].compareTo(keys[pq[j]]) &gt; <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">exch</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> swap = pq[i];</div><div class="line">        pq[i] = pq[j];</div><div class="line">        pq[j] = swap;</div><div class="line">        qp[pq[i]] = i;</div><div class="line">        qp[pq[j]] = j;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">/***************************************************************************</span></div><div class="line">    * Heap helper functions.</div><div class="line">    ***************************************************************************/</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; greater(k/<span class="number">2</span>, k)) &#123;</div><div class="line">            exch(k, k/<span class="number">2</span>);</div><div class="line">            k = k/<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sink</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (<span class="number">2</span>*k &lt;= n) &#123;</div><div class="line">            <span class="keyword">int</span> j = <span class="number">2</span>*k;</div><div class="line">            <span class="keyword">if</span> (j &lt; n &amp;&amp; greater(j, j+<span class="number">1</span>)) j++;</div><div class="line">            <span class="keyword">if</span> (!greater(k, j)) <span class="keyword">break</span>;</div><div class="line">            exch(k, j);</div><div class="line">            k = j;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">/***************************************************************************</span></div><div class="line">    * Iterators.</div><div class="line">    ***************************************************************************/</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns an iterator that iterates over the keys on the</div><div class="line">     * priority queue in ascending order.</div><div class="line">     * The iterator doesn't implement &#123;<span class="doctag">@code</span> remove()&#125; since it's optional.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> an iterator that iterates over the keys in ascending order</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;Integer&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> HeapIterator(); &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</div><div class="line">        <span class="comment">// create a new pq</span></div><div class="line">        <span class="keyword">private</span> IndexMinPQ&lt;Key&gt; copy;</div><div class="line"></div><div class="line">        <span class="comment">// add all elements to copy of heap</span></div><div class="line">        <span class="comment">// takes linear time since already in heap order so no keys move</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">HeapIterator</span><span class="params">()</span> </span>&#123;</div><div class="line">            copy = <span class="keyword">new</span> IndexMinPQ&lt;Key&gt;(pq.length - <span class="number">1</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">                copy.insert(pq[i], keys[pq[i]]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span>  </span>&#123; <span class="keyword">return</span> !copy.isEmpty();                     &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span>      </span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();  &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">next</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (!hasNext()) <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</div><div class="line">            <span class="keyword">return</span> copy.delMin();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> IndexMinPQ&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="comment">// insert a bunch of strings</span></div><div class="line">        String[] strings = &#123; <span class="string">"it"</span>, <span class="string">"was"</span>, <span class="string">"the"</span>, <span class="string">"best"</span>, <span class="string">"of"</span>, <span class="string">"times"</span>, <span class="string">"it"</span>, <span class="string">"was"</span>, <span class="string">"the"</span>, <span class="string">"worst"</span> &#125;;</div><div class="line"></div><div class="line">        IndexMinPQ&lt;String&gt; pq = <span class="keyword">new</span> IndexMinPQ&lt;String&gt;(strings.length);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strings.length; i++) &#123;</div><div class="line">            pq.insert(i, strings[i]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// delete and print each key</span></div><div class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> i = pq.delMin();</div><div class="line">            StdOut.println(i + <span class="string">" "</span> + strings[i]);</div><div class="line">        &#125;</div><div class="line">        StdOut.println();</div><div class="line"></div><div class="line">        <span class="comment">// reinsert the same strings</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strings.length; i++) &#123;</div><div class="line">            pq.insert(i, strings[i]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// print each key using the iterator</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : pq) &#123;</div><div class="line">            StdOut.println(i + <span class="string">" "</span> + strings[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</div><div class="line">            pq.delMin();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Kruskal-算法"><a href="#Kruskal-算法" class="headerlink" title="Kruskal 算法"></a>Kruskal 算法</h4><p>思想：按照边的权重顺序（从小到大）来处理它们；</p>
<p>java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KruskalMST</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> FLOATING_POINT_EPSILON = <span class="number">1E-12</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> weight;                        <span class="comment">// weight of MST</span></div><div class="line">    <span class="keyword">private</span> Queue&lt;Edge&gt; mst = <span class="keyword">new</span> Queue&lt;Edge&gt;();  <span class="comment">// edges in MST</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Compute a minimum spanning tree (or forest) of an edge-weighted graph.</div><div class="line">     * <span class="doctag">@param</span> G the edge-weighted graph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">KruskalMST</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line">        <span class="comment">// more efficient to build heap by passing array of edges</span></div><div class="line">        MinPQ&lt;Edge&gt; pq = <span class="keyword">new</span> MinPQ&lt;Edge&gt;();</div><div class="line">        <span class="keyword">for</span> (Edge e : G.edges()) &#123;</div><div class="line">            pq.insert(e);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// run greedy algorithm</span></div><div class="line">        UF uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">        <span class="keyword">while</span> (!pq.isEmpty() &amp;&amp; mst.size() &lt; G.V() - <span class="number">1</span>) &#123;</div><div class="line">            Edge e = pq.delMin();</div><div class="line">            <span class="keyword">int</span> v = e.either();</div><div class="line">            <span class="keyword">int</span> w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (!uf.connected(v, w)) &#123; <span class="comment">// v-w does not create a cycle</span></div><div class="line">                uf.union(v, w);  <span class="comment">// merge v and w components</span></div><div class="line">                mst.enqueue(e);  <span class="comment">// add edge e to mst</span></div><div class="line">                weight += e.weight();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check optimality conditions</span></div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">check</span><span class="params">(G)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the edges in a minimum spanning tree (or forest).</div><div class="line">     * <span class="doctag">@return</span> the edges in a minimum spanning tree (or forest) as</div><div class="line">     *    an iterable of edges</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Edge&gt; <span class="title">edges</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mst;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the sum of the edge weights in a minimum spanning tree (or forest).</div><div class="line">     * <span class="doctag">@return</span> the sum of the edge weights in a minimum spanning tree (or forest)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// check optimality conditions (takes time proportional to E V lg* V)</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(EdgeWeightedGraph G)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// check total weight</span></div><div class="line">        <span class="keyword">double</span> total = <span class="number">0.0</span>;</div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line">            total += e.weight();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (Math.abs(total - weight()) &gt; FLOATING_POINT_EPSILON) &#123;</div><div class="line">            System.err.printf(<span class="string">"Weight of edges does not equal weight(): %f vs. %f\n"</span>, total, weight());</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is acyclic</span></div><div class="line">        UF uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (uf.connected(v, w)) &#123;</div><div class="line">                System.err.println(<span class="string">"Not a forest"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            uf.union(v, w);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is a spanning forest</span></div><div class="line">        <span class="keyword">for</span> (Edge e : G.edges()) &#123;</div><div class="line">            <span class="keyword">int</span> v = e.either(), w = e.other(v);</div><div class="line">            <span class="keyword">if</span> (!uf.connected(v, w)) &#123;</div><div class="line">                System.err.println(<span class="string">"Not a spanning forest"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that it is a minimal spanning forest (cut optimality conditions)</span></div><div class="line">        <span class="keyword">for</span> (Edge e : edges()) &#123;</div><div class="line"></div><div class="line">            <span class="comment">// all edges in MST except e</span></div><div class="line">            uf = <span class="keyword">new</span> UF(G.V());</div><div class="line">            <span class="keyword">for</span> (Edge f : mst) &#123;</div><div class="line">                <span class="keyword">int</span> x = f.either(), y = f.other(x);</div><div class="line">                <span class="keyword">if</span> (f != e) uf.union(x, y);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">// check that e is min weight edge in crossing cut</span></div><div class="line">            <span class="keyword">for</span> (Edge f : G.edges()) &#123;</div><div class="line">                <span class="keyword">int</span> x = f.either(), y = f.other(x);</div><div class="line">                <span class="keyword">if</span> (!uf.connected(x, y)) &#123;</div><div class="line">                    <span class="keyword">if</span> (f.weight() &lt; e.weight()) &#123;</div><div class="line">                        System.err.println(<span class="string">"Edge "</span> + f + <span class="string">" violates cut optimality conditions"</span>);</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> KruskalMST&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        EdgeWeightedGraph G = <span class="keyword">new</span> EdgeWeightedGraph(in);</div><div class="line">        KruskalMST mst = <span class="keyword">new</span> KruskalMST(G);</div><div class="line">        <span class="keyword">for</span> (Edge e : mst.edges()) &#123;</div><div class="line">            StdOut.println(e);</div><div class="line">        &#125;</div><div class="line">        StdOut.printf(<span class="string">"%.5f\n"</span>, mst.weight());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="最短路径"><a href="#最短路径" class="headerlink" title="最短路径"></a>最短路径</h3><p> 定义：在一幅加权有向图中，从顶点s 到顶点 t 的最短路径是所有从s到t的路径中的权重最小者；</p>
<h4 id="最短路径树"><a href="#最短路径树" class="headerlink" title="最短路径树"></a>最短路径树</h4><p>解决的是单点最短路径问题；</p>
<p>定义：给定一幅加权有向图和一个顶点s， 以s 为起点的一棵 最短路径树是图的一幅子图，它包含s和从s可达的所有顶点。这个有向树的根结点是s，树的每条路径都是有向图中的一条最短路径；</p>
<h4 id="加权有向边"><a href="#加权有向边" class="headerlink" title="加权有向边"></a>加权有向边</h4><p>Java 实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DirectedEdge</span> </span>&#123; </div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> v;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> w;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> weight;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a directed edge from vertex &#123;<span class="doctag">@code</span> v&#125; to vertex &#123;<span class="doctag">@code</span> w&#125; with</div><div class="line">     * the given &#123;<span class="doctag">@code</span> weight&#125;.</div><div class="line">     * <span class="doctag">@param</span> v the tail vertex</div><div class="line">     * <span class="doctag">@param</span> w the head vertex</div><div class="line">     * <span class="doctag">@param</span> weight the weight of the directed edge</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if either &#123;<span class="doctag">@code</span> v&#125; or &#123;<span class="doctag">@code</span> w&#125;</div><div class="line">     *    is a negative integer</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> weight&#125; is &#123;<span class="doctag">@code</span> NaN&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DirectedEdge</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> w, <span class="keyword">double</span> weight)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Vertex names must be nonnegative integers"</span>);</div><div class="line">        <span class="keyword">if</span> (w &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Vertex names must be nonnegative integers"</span>);</div><div class="line">        <span class="keyword">if</span> (Double.isNaN(weight)) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Weight is NaN"</span>);</div><div class="line">        <span class="keyword">this</span>.v = v;</div><div class="line">        <span class="keyword">this</span>.w = w;</div><div class="line">        <span class="keyword">this</span>.weight = weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the tail vertex of the directed edge.</div><div class="line">     * <span class="doctag">@return</span> the tail vertex of the directed edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">from</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the head vertex of the directed edge.</div><div class="line">     * <span class="doctag">@return</span> the head vertex of the directed edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">to</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> w;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the weight of the directed edge.</div><div class="line">     * <span class="doctag">@return</span> the weight of the directed edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">weight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a string representation of the directed edge.</div><div class="line">     * <span class="doctag">@return</span> a string representation of the directed edge</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v + <span class="string">"-&gt;"</span> + w + <span class="string">" "</span> + String.format(<span class="string">"%5.2f"</span>, weight);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> DirectedEdge&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        DirectedEdge e = <span class="keyword">new</span> DirectedEdge(<span class="number">12</span>, <span class="number">34</span>, <span class="number">5.67</span>);</div><div class="line">        StdOut.println(e);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="加权有向图"><a href="#加权有向图" class="headerlink" title="加权有向图"></a>加权有向图</h4><p>java 实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EdgeWeightedDigraph</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String NEWLINE = System.getProperty(<span class="string">"line.separator"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> V;                <span class="comment">// number of vertices in this digraph</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> E;                      <span class="comment">// number of edges in this digraph</span></div><div class="line">    <span class="keyword">private</span> Bag&lt;DirectedEdge&gt;[] adj;    <span class="comment">// adj[v] = adjacency list for vertex v</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] indegree;             <span class="comment">// indegree[v] = indegree of vertex v</span></div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes an empty edge-weighted digraph with &#123;<span class="doctag">@code</span> V&#125; vertices and 0 edges.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  V the number of vertices</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> V &lt; 0&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedDigraph</span><span class="params">(<span class="keyword">int</span> V)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (V &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of vertices in a Digraph must be nonnegative"</span>);</div><div class="line">        <span class="keyword">this</span>.V = V;</div><div class="line">        <span class="keyword">this</span>.E = <span class="number">0</span>;</div><div class="line">        <span class="keyword">this</span>.indegree = <span class="keyword">new</span> <span class="keyword">int</span>[V];</div><div class="line">        adj = (Bag&lt;DirectedEdge&gt;[]) <span class="keyword">new</span> Bag[V];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++)</div><div class="line">            adj[v] = <span class="keyword">new</span> Bag&lt;DirectedEdge&gt;();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a random edge-weighted digraph with &#123;<span class="doctag">@code</span> V&#125; vertices and &lt;em&gt;E&lt;/em&gt; edges.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  V the number of vertices</div><div class="line">     * <span class="doctag">@param</span>  E the number of edges</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> V &lt; 0&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> E &lt; 0&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedDigraph</span><span class="params">(<span class="keyword">int</span> V, <span class="keyword">int</span> E)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(V);</div><div class="line">        <span class="keyword">if</span> (E &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of edges in a Digraph must be nonnegative"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; i++) &#123;</div><div class="line">            <span class="keyword">int</span> v = StdRandom.uniform(V);</div><div class="line">            <span class="keyword">int</span> w = StdRandom.uniform(V);</div><div class="line">            <span class="keyword">double</span> weight = <span class="number">0.01</span> * StdRandom.uniform(<span class="number">100</span>);</div><div class="line">            DirectedEdge e = <span class="keyword">new</span> DirectedEdge(v, w, weight);</div><div class="line">            addEdge(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**  </span></div><div class="line">     * Initializes an edge-weighted digraph from the specified input stream.</div><div class="line">     * The format is the number of vertices &lt;em&gt;V&lt;/em&gt;,</div><div class="line">     * followed by the number of edges &lt;em&gt;E&lt;/em&gt;,</div><div class="line">     * followed by &lt;em&gt;E&lt;/em&gt; pairs of vertices and edge weights,</div><div class="line">     * with each entry separated by whitespace.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  in the input stream</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if the endpoints of any edge are not in prescribed range</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if the number of vertices or edges is negative</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedDigraph</span><span class="params">(In in)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(in.readInt());</div><div class="line">        <span class="keyword">int</span> E = in.readInt();</div><div class="line">        <span class="keyword">if</span> (E &lt; <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Number of edges must be nonnegative"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; i++) &#123;</div><div class="line">            <span class="keyword">int</span> v = in.readInt();</div><div class="line">            <span class="keyword">int</span> w = in.readInt();</div><div class="line">            validateVertex(v);</div><div class="line">            validateVertex(w);</div><div class="line">            <span class="keyword">double</span> weight = in.readDouble();</div><div class="line">            addEdge(<span class="keyword">new</span> DirectedEdge(v, w, weight));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Initializes a new edge-weighted digraph that is a deep copy of &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  G the edge-weighted digraph to copy</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EdgeWeightedDigraph</span><span class="params">(EdgeWeightedDigraph G)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(G.V());</div><div class="line">        <span class="keyword">this</span>.E = G.E();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            <span class="keyword">this</span>.indegree[v] = G.indegree(v);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="comment">// reverse so that adjacency list is in same order as original</span></div><div class="line">            Stack&lt;DirectedEdge&gt; reverse = <span class="keyword">new</span> Stack&lt;DirectedEdge&gt;();</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : G.adj[v]) &#123;</div><div class="line">                reverse.push(e);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : reverse) &#123;</div><div class="line">                adj[v].add(e);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of vertices in this edge-weighted digraph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of vertices in this edge-weighted digraph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">V</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> V;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of edges in this edge-weighted digraph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of edges in this edge-weighted digraph</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">E</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> E;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Adds the directed edge &#123;<span class="doctag">@code</span> e&#125; to this edge-weighted digraph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  e the edge</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless endpoints of edge are between &#123;<span class="doctag">@code</span> 0&#125;</div><div class="line">     *         and &#123;<span class="doctag">@code</span> V-1&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(DirectedEdge e)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> v = e.from();</div><div class="line">        <span class="keyword">int</span> w = e.to();</div><div class="line">        validateVertex(v);</div><div class="line">        validateVertex(w);</div><div class="line">        adj[v].add(e);</div><div class="line">        indegree[w]++;</div><div class="line">        E++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the directed edges incident from vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the directed edges incident from vertex &#123;<span class="doctag">@code</span> v&#125; as an Iterable</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">adj</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> adj[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of directed edges incident from vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * This is known as the &lt;em&gt;outdegree&lt;/em&gt; of vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the outdegree of vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">outdegree</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> adj[v].size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the number of directed edges incident to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * This is known as the &lt;em&gt;indegree&lt;/em&gt; of vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the vertex</div><div class="line">     * <span class="doctag">@return</span> the indegree of vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indegree</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> indegree[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns all directed edges in this edge-weighted digraph.</div><div class="line">     * To iterate over the edges in this edge-weighted digraph, use foreach notation:</div><div class="line">     * &#123;<span class="doctag">@code</span> for (DirectedEdge e : G.edges())&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> all edges in this edge-weighted digraph, as an iterable</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">edges</span><span class="params">()</span> </span>&#123;</div><div class="line">        Bag&lt;DirectedEdge&gt; list = <span class="keyword">new</span> Bag&lt;DirectedEdge&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : adj(v)) &#123;</div><div class="line">                list.add(e);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125; </div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a string representation of this edge-weighted digraph.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> the number of vertices &lt;em&gt;V&lt;/em&gt;, followed by the number of edges &lt;em&gt;E&lt;/em&gt;,</div><div class="line">     *         followed by the &lt;em&gt;V&lt;/em&gt; adjacency lists of edges</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder s = <span class="keyword">new</span> StringBuilder();</div><div class="line">        s.append(V + <span class="string">" "</span> + E + NEWLINE);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) &#123;</div><div class="line">            s.append(v + <span class="string">": "</span>);</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : adj[v]) &#123;</div><div class="line">                s.append(e + <span class="string">"  "</span>);</div><div class="line">            &#125;</div><div class="line">            s.append(NEWLINE);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> s.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> EdgeWeightedDigraph&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        EdgeWeightedDigraph G = <span class="keyword">new</span> EdgeWeightedDigraph(in);</div><div class="line">        StdOut.println(G);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="松弛操作-Relaxation"><a href="#松弛操作-Relaxation" class="headerlink" title="松弛操作 Relaxation"></a>松弛操作 Relaxation</h4><p>定义： 放松边 v -&gt; w 意味着检查从 s（原点）到 w 的最短路径是否是先从 s 到 v，然后再由 v到w。如果是，则根据这个情况更新数据结构的内容；否则这个边失效；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] distTo;  <span class="comment">//distTo[v]表示从顶点s 到 v 的距离，或者说是长度；</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">relax</span><span class="params">(DirectedEdge e)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> v = e.from(), w = e.to();</div><div class="line">    <span class="keyword">if</span> (distTo[w] &gt;  distTo[v] + e.weight()) &#123;</div><div class="line">        distTo[w] = distTo[v] + e.weigth();</div><div class="line">        edgeTo[w] = e;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Dijkstra-算法"><a href="#Dijkstra-算法" class="headerlink" title="Dijkstra 算法"></a>Dijkstra 算法</h4><p><strong>Dijkstra 算法能够解决边权重非负的加权有向图的单起点最短路径问题</strong></p>
<p>需要的数据结构：distTo[] 、edgeTo[]和 IndexMinPQ 索引队列；</p>
<p>索引队列用来保存需要被放松的顶点并确认下一个被放松的顶点。</p>
<p>java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DijkstraSP</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] distTo;          <span class="comment">// distTo[v] = distance  of shortest s-&gt;v path</span></div><div class="line">    <span class="keyword">private</span> DirectedEdge[] edgeTo;    <span class="comment">// edgeTo[v] = last edge on shortest s-&gt;v path</span></div><div class="line">    <span class="keyword">private</span> IndexMinPQ&lt;Double&gt; pq;    <span class="comment">// priority queue of vertices</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes a shortest-paths tree from the source vertex &#123;<span class="doctag">@code</span> s&#125; to every other</div><div class="line">     * vertex in the edge-weighted digraph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  G the edge-weighted digraph</div><div class="line">     * <span class="doctag">@param</span>  s the source vertex</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if an edge weight is negative</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DijkstraSP</span><span class="params">(EdgeWeightedDigraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (DirectedEdge e : G.edges()) &#123;</div><div class="line">            <span class="keyword">if</span> (e.weight() &lt; <span class="number">0</span>)</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"edge "</span> + e + <span class="string">" has negative weight"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        distTo = <span class="keyword">new</span> <span class="keyword">double</span>[G.V()];</div><div class="line">        edgeTo = <span class="keyword">new</span> DirectedEdge[G.V()];</div><div class="line"></div><div class="line">        validateVertex(s);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            distTo[v] = Double.POSITIVE_INFINITY;</div><div class="line">        distTo[s] = <span class="number">0.0</span>;</div><div class="line"></div><div class="line">        <span class="comment">// relax vertices in order of distance from s</span></div><div class="line">        pq = <span class="keyword">new</span> IndexMinPQ&lt;Double&gt;(G.V());</div><div class="line">        pq.insert(s, distTo[s]);</div><div class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> v = pq.delMin();</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : G.adj(v))</div><div class="line">                relax(e);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check optimality conditions</span></div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">check</span><span class="params">(G, s)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// relax edge e and update pq if changed</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">relax</span><span class="params">(DirectedEdge e)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> v = e.from(), w = e.to();</div><div class="line">        <span class="keyword">if</span> (distTo[w] &gt; distTo[v] + e.weight()) &#123;</div><div class="line">            distTo[w] = distTo[v] + e.weight();</div><div class="line">            edgeTo[w] = e;</div><div class="line">            <span class="keyword">if</span> (pq.contains(w)) pq.decreaseKey(w, distTo[w]);</div><div class="line">            <span class="keyword">else</span>                pq.insert(w, distTo[w]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the length of a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> the length of a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;;</div><div class="line">     *         &#123;<span class="doctag">@code</span> Double.POSITIVE_INFINITY&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">distTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> distTo[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns true if there is a path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a path from the source vertex</div><div class="line">     *         &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;; &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> distTo[v] &lt; Double.POSITIVE_INFINITY;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     *         as an iterable of edges, and &#123;<span class="doctag">@code</span> null&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">pathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">if</span> (!hasPathTo(v)) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        Stack&lt;DirectedEdge&gt; path = <span class="keyword">new</span> Stack&lt;DirectedEdge&gt;();</div><div class="line">        <span class="keyword">for</span> (DirectedEdge e = edgeTo[v]; e != <span class="keyword">null</span>; e = edgeTo[e.from()]) &#123;</div><div class="line">            path.push(e);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// check optimality conditions:</span></div><div class="line">    <span class="comment">// (i) for all edges e:            distTo[e.to()] &lt;= distTo[e.from()] + e.weight()</span></div><div class="line">    <span class="comment">// (ii) for all edge e on the SPT: distTo[e.to()] == distTo[e.from()] + e.weight()</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(EdgeWeightedDigraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// check that edge weights are nonnegative</span></div><div class="line">        <span class="keyword">for</span> (DirectedEdge e : G.edges()) &#123;</div><div class="line">            <span class="keyword">if</span> (e.weight() &lt; <span class="number">0</span>) &#123;</div><div class="line">                System.err.println(<span class="string">"negative edge weight detected"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that distTo[v] and edgeTo[v] are consistent</span></div><div class="line">        <span class="keyword">if</span> (distTo[s] != <span class="number">0.0</span> || edgeTo[s] != <span class="keyword">null</span>) &#123;</div><div class="line">            System.err.println(<span class="string">"distTo[s] and edgeTo[s] inconsistent"</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">if</span> (v == s) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span> (edgeTo[v] == <span class="keyword">null</span> &amp;&amp; distTo[v] != Double.POSITIVE_INFINITY) &#123;</div><div class="line">                System.err.println(<span class="string">"distTo[] and edgeTo[] inconsistent"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that all edges e = v-&gt;w satisfy distTo[w] &lt;= distTo[v] + e.weight()</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : G.adj(v)) &#123;</div><div class="line">                <span class="keyword">int</span> w = e.to();</div><div class="line">                <span class="keyword">if</span> (distTo[v] + e.weight() &lt; distTo[w]) &#123;</div><div class="line">                    System.err.println(<span class="string">"edge "</span> + e + <span class="string">" not relaxed"</span>);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// check that all edges e = v-&gt;w on SPT satisfy distTo[w] == distTo[v] + e.weight()</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">0</span>; w &lt; G.V(); w++) &#123;</div><div class="line">            <span class="keyword">if</span> (edgeTo[w] == <span class="keyword">null</span>) <span class="keyword">continue</span>;</div><div class="line">            DirectedEdge e = edgeTo[w];</div><div class="line">            <span class="keyword">int</span> v = e.from();</div><div class="line">            <span class="keyword">if</span> (w != e.to()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            <span class="keyword">if</span> (distTo[v] + e.weight() != distTo[w]) &#123;</div><div class="line">                System.err.println(<span class="string">"edge "</span> + e + <span class="string">" on shortest path not tight"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = distTo.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> DijkstraSP&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        EdgeWeightedDigraph G = <span class="keyword">new</span> EdgeWeightedDigraph(in);</div><div class="line">        <span class="keyword">int</span> s = Integer.parseInt(args[<span class="number">1</span>]);</div><div class="line"></div><div class="line">        <span class="comment">// compute shortest paths</span></div><div class="line">        DijkstraSP sp = <span class="keyword">new</span> DijkstraSP(G, s);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// print shortest path</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">0</span>; t &lt; G.V(); t++) &#123;</div><div class="line">            <span class="keyword">if</span> (sp.hasPathTo(t)) &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d (%.2f)  "</span>, s, t, sp.distTo(t));</div><div class="line">                <span class="keyword">for</span> (DirectedEdge e : sp.pathTo(t)) &#123;</div><div class="line">                    StdOut.print(e + <span class="string">"   "</span>);</div><div class="line">                &#125;</div><div class="line">                StdOut.println();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d         no path\n"</span>, s, t);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>应用：</p>
<ol>
<li><p>给定两点的最短路径</p>
</li>
<li><p>任意顶点之间的最短路径</p>
<p>java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DijkstraAllPairsSP</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> DijkstraSP[] all;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes a shortest paths tree from each vertex to to every other vertex in</div><div class="line">     * the edge-weighted digraph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@param</span> G the edge-weighted digraph</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if an edge weight is negative</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DijkstraAllPairsSP</span><span class="params">(EdgeWeightedDigraph G)</span> </span>&#123;</div><div class="line">        all  = <span class="keyword">new</span> DijkstraSP[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            all[v] = <span class="keyword">new</span> DijkstraSP(G, v);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a shortest path from vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> t&#125;.</div><div class="line">     * <span class="doctag">@param</span>  s the source vertex</div><div class="line">     * <span class="doctag">@param</span>  t the destination vertex</div><div class="line">     * <span class="doctag">@return</span> a shortest path from vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> t&#125;</div><div class="line">     *         as an iterable of edges, and &#123;<span class="doctag">@code</span> null&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= t &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">path</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">        validateVertex(s);</div><div class="line">        validateVertex(t);</div><div class="line">        <span class="keyword">return</span> all[s].pathTo(t);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is there a path from the vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> t&#125;?</div><div class="line">     * <span class="doctag">@param</span>  s the source vertex</div><div class="line">     * <span class="doctag">@param</span>  t the destination vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a path from vertex &#123;<span class="doctag">@code</span> s&#125; </div><div class="line">     *         to vertex &#123;<span class="doctag">@code</span> t&#125;, and &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= t &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPath</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">        validateVertex(s);</div><div class="line">        validateVertex(t);</div><div class="line">        <span class="keyword">return</span> dist(s, t) &lt; Double.POSITIVE_INFINITY;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the length of a shortest path from vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> t&#125;.</div><div class="line">     * <span class="doctag">@param</span>  s the source vertex</div><div class="line">     * <span class="doctag">@param</span>  t the destination vertex</div><div class="line">     * <span class="doctag">@return</span> the length of a shortest path from vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> t&#125;;</div><div class="line">     *         &#123;<span class="doctag">@code</span> Double.POSITIVE_INFINITY&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= t &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">dist</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">        validateVertex(s);</div><div class="line">        validateVertex(t);</div><div class="line">        <span class="keyword">return</span> all[s].distTo(t);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = all.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="加权有向无环图的最短路径算法"><a href="#加权有向无环图的最短路径算法" class="headerlink" title="加权有向无环图的最短路径算法"></a>加权有向无环图的最短路径算法</h3><p>思想：将顶点的放松和拓扑排序结合起来；</p>
<p>首先用拓扑排序得到图的所有顶点，然后放松所有顶点；</p>
<p>java 实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AcyclicSP</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] distTo;         <span class="comment">// distTo[v] = distance  of shortest s-&gt;v path</span></div><div class="line">    <span class="keyword">private</span> DirectedEdge[] edgeTo;   <span class="comment">// edgeTo[v] = last edge on shortest s-&gt;v path</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes a shortest paths tree from &#123;<span class="doctag">@code</span> s&#125; to every other vertex in</div><div class="line">     * the directed acyclic graph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@param</span> G the acyclic digraph</div><div class="line">     * <span class="doctag">@param</span> s the source vertex</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException if the digraph is not acyclic</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AcyclicSP</span><span class="params">(EdgeWeightedDigraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        distTo = <span class="keyword">new</span> <span class="keyword">double</span>[G.V()];</div><div class="line">        edgeTo = <span class="keyword">new</span> DirectedEdge[G.V()];</div><div class="line"></div><div class="line">        validateVertex(s);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            distTo[v] = Double.POSITIVE_INFINITY;</div><div class="line">        distTo[s] = <span class="number">0.0</span>;</div><div class="line"></div><div class="line">        <span class="comment">// visit vertices in topological order</span></div><div class="line">        Topological topological = <span class="keyword">new</span> Topological(G);</div><div class="line">        <span class="keyword">if</span> (!topological.hasOrder())</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Digraph is not acyclic."</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v : topological.order()) &#123;</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : G.adj(v))</div><div class="line">                relax(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// relax edge e</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">relax</span><span class="params">(DirectedEdge e)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> v = e.from(), w = e.to();</div><div class="line">        <span class="keyword">if</span> (distTo[w] &gt; distTo[v] + e.weight()) &#123;</div><div class="line">            distTo[w] = distTo[v] + e.weight();</div><div class="line">            edgeTo[w] = e;</div><div class="line">        &#125;       </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the length of a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> the length of a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;;</div><div class="line">     *         &#123;<span class="doctag">@code</span> Double.POSITIVE_INFINITY&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">distTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> distTo[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is there a path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;?</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a path from the source vertex</div><div class="line">     *         &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;, and &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> distTo[v] &lt; Double.POSITIVE_INFINITY;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     *         as an iterable of edges, and &#123;<span class="doctag">@code</span> null&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">pathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">if</span> (!hasPathTo(v)) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        Stack&lt;DirectedEdge&gt; path = <span class="keyword">new</span> Stack&lt;DirectedEdge&gt;();</div><div class="line">        <span class="keyword">for</span> (DirectedEdge e = edgeTo[v]; e != <span class="keyword">null</span>; e = edgeTo[e.from()]) &#123;</div><div class="line">            path.push(e);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = distTo.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> AcyclicSP&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">int</span> s = Integer.parseInt(args[<span class="number">1</span>]);</div><div class="line">        EdgeWeightedDigraph G = <span class="keyword">new</span> EdgeWeightedDigraph(in);</div><div class="line"></div><div class="line">        <span class="comment">// find shortest path from s to each other vertex in DAG</span></div><div class="line">        AcyclicSP sp = <span class="keyword">new</span> AcyclicSP(G, s);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">            <span class="keyword">if</span> (sp.hasPathTo(v)) &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d (%.2f)  "</span>, s, v, sp.distTo(v));</div><div class="line">                <span class="keyword">for</span> (DirectedEdge e : sp.pathTo(v)) &#123;</div><div class="line">                    StdOut.print(e + <span class="string">"   "</span>);</div><div class="line">                &#125;</div><div class="line">                StdOut.println();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                StdOut.printf(<span class="string">"%d to %d         no path\n"</span>, s, v);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Bellman-Ford-算法"><a href="#Bellman-Ford-算法" class="headerlink" title="Bellman-Ford 算法"></a>Bellman-Ford 算法</h4><p>定义：在任意含有 V 个顶点的加权有向图中给定起点 s ， 从 s 无法到达任何负权重环，一下算法够解决其中的单点最短路径问题：将 distTo[s] 初始化为 0， 其他 distTo[] 元素初始化为无穷大，以任意顺序放松有向图的所有边，重复 V轮；</p>
<p>需要的数据结构：</p>
<ol>
<li>一条用来保存即将被放松的顶点的队列queue；</li>
<li>一个由顶点索引的 boolean 数组 onQ[]，用来指示顶点是否已经存在于队列中，防止重复插入；</li>
</ol>
<p>Java 实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BellmanFordSP</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] distTo;               <span class="comment">// distTo[v] = distance  of shortest s-&gt;v path</span></div><div class="line">    <span class="keyword">private</span> DirectedEdge[] edgeTo;         <span class="comment">// edgeTo[v] = last edge on shortest s-&gt;v path</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] onQueue;             <span class="comment">// onQueue[v] = is v currently on the queue?</span></div><div class="line">    <span class="keyword">private</span> Queue&lt;Integer&gt; queue;          <span class="comment">// queue of vertices to relax</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cost;                      <span class="comment">// number of calls to relax()</span></div><div class="line">    <span class="keyword">private</span> Iterable&lt;DirectedEdge&gt; cycle;  <span class="comment">// negative cycle (or null if no such cycle)</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Computes a shortest paths tree from &#123;<span class="doctag">@code</span> s&#125; to every other vertex in</div><div class="line">     * the edge-weighted digraph &#123;<span class="doctag">@code</span> G&#125;.</div><div class="line">     * <span class="doctag">@param</span> G the acyclic digraph</div><div class="line">     * <span class="doctag">@param</span> s the source vertex</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= s &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BellmanFordSP</span><span class="params">(EdgeWeightedDigraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">        distTo  = <span class="keyword">new</span> <span class="keyword">double</span>[G.V()];</div><div class="line">        edgeTo  = <span class="keyword">new</span> DirectedEdge[G.V()];</div><div class="line">        onQueue = <span class="keyword">new</span> <span class="keyword">boolean</span>[G.V()];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++)</div><div class="line">            distTo[v] = Double.POSITIVE_INFINITY;</div><div class="line">        distTo[s] = <span class="number">0.0</span>;</div><div class="line"></div><div class="line">        <span class="comment">// Bellman-Ford algorithm</span></div><div class="line">        queue = <span class="keyword">new</span> Queue&lt;Integer&gt;();</div><div class="line">        queue.enqueue(s);</div><div class="line">        onQueue[s] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">while</span> (!queue.isEmpty() &amp;&amp; !hasNegativeCycle()) &#123;</div><div class="line">            <span class="keyword">int</span> v = queue.dequeue();</div><div class="line">            onQueue[v] = <span class="keyword">false</span>;</div><div class="line">            relax(G, v);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">check</span><span class="params">(G, s)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// relax vertex v and put other endpoints on queue if changed</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">relax</span><span class="params">(EdgeWeightedDigraph G, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (DirectedEdge e : G.adj(v)) &#123;</div><div class="line">            <span class="keyword">int</span> w = e.to();</div><div class="line">            <span class="keyword">if</span> (distTo[w] &gt; distTo[v] + e.weight()) &#123;</div><div class="line">                distTo[w] = distTo[v] + e.weight();</div><div class="line">                edgeTo[w] = e;</div><div class="line">                <span class="keyword">if</span> (!onQueue[w]) &#123;</div><div class="line">                    queue.enqueue(w);</div><div class="line">                    onQueue[w] = <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (cost++ % G.V() == <span class="number">0</span>) &#123;</div><div class="line">                findNegativeCycle();</div><div class="line">                <span class="keyword">if</span> (hasNegativeCycle()) <span class="keyword">return</span>;  <span class="comment">// found a negative cycle</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is there a negative cycle reachable from the source vertex &#123;<span class="doctag">@code</span> s&#125;?</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a negative cycle reachable from the</div><div class="line">     *    source vertex &#123;<span class="doctag">@code</span> s&#125;, and &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNegativeCycle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> cycle != <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a negative cycle reachable from the source vertex &#123;<span class="doctag">@code</span> s&#125;, or &#123;<span class="doctag">@code</span> null&#125;</div><div class="line">     * if there is no such cycle.</div><div class="line">     * <span class="doctag">@return</span> a negative cycle reachable from the soruce vertex &#123;<span class="doctag">@code</span> s&#125; </div><div class="line">     *    as an iterable of edges, and &#123;<span class="doctag">@code</span> null&#125; if there is no such cycle</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">negativeCycle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> cycle;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// by finding a cycle in predecessor graph</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">findNegativeCycle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = edgeTo.length;</div><div class="line">        EdgeWeightedDigraph spt = <span class="keyword">new</span> EdgeWeightedDigraph(V);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++)</div><div class="line">            <span class="keyword">if</span> (edgeTo[v] != <span class="keyword">null</span>)</div><div class="line">                spt.addEdge(edgeTo[v]);</div><div class="line"></div><div class="line">        EdgeWeightedDirectedCycle finder = <span class="keyword">new</span> EdgeWeightedDirectedCycle(spt);</div><div class="line">        cycle = finder.cycle();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns the length of a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> the length of a shortest path from the source vertex &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;;</div><div class="line">     *         &#123;<span class="doctag">@code</span> Double.POSITIVE_INFINITY&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> UnsupportedOperationException if there is a negative cost cycle reachable</div><div class="line">     *         from the source vertex &#123;<span class="doctag">@code</span> s&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">distTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">if</span> (hasNegativeCycle())</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"Negative cost cycle exists"</span>);</div><div class="line">        <span class="keyword">return</span> distTo[v];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Is there a path from the source &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;?</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there is a path from the source vertex</div><div class="line">     *         &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;, and &#123;<span class="doctag">@code</span> false&#125; otherwise</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">return</span> distTo[v] &lt; Double.POSITIVE_INFINITY;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Returns a shortest path from the source &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;.</div><div class="line">     * <span class="doctag">@param</span>  v the destination vertex</div><div class="line">     * <span class="doctag">@return</span> a shortest path from the source &#123;<span class="doctag">@code</span> s&#125; to vertex &#123;<span class="doctag">@code</span> v&#125;</div><div class="line">     *         as an iterable of edges, and &#123;<span class="doctag">@code</span> null&#125; if no such path</div><div class="line">     * <span class="doctag">@throws</span> UnsupportedOperationException if there is a negative cost cycle reachable</div><div class="line">     *         from the source vertex &#123;<span class="doctag">@code</span> s&#125;</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException unless &#123;<span class="doctag">@code</span> 0 &lt;= v &lt; V&#125;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;DirectedEdge&gt; <span class="title">pathTo</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        validateVertex(v);</div><div class="line">        <span class="keyword">if</span> (hasNegativeCycle())</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"Negative cost cycle exists"</span>);</div><div class="line">        <span class="keyword">if</span> (!hasPathTo(v)) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        Stack&lt;DirectedEdge&gt; path = <span class="keyword">new</span> Stack&lt;DirectedEdge&gt;();</div><div class="line">        <span class="keyword">for</span> (DirectedEdge e = edgeTo[v]; e != <span class="keyword">null</span>; e = edgeTo[e.from()]) &#123;</div><div class="line">            path.push(e);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// check optimality conditions: either </span></div><div class="line">    <span class="comment">// (i) there exists a negative cycle reacheable from s</span></div><div class="line">    <span class="comment">//     or </span></div><div class="line">    <span class="comment">// (ii)  for all edges e = v-&gt;w:            distTo[w] &lt;= distTo[v] + e.weight()</span></div><div class="line">    <span class="comment">// (ii') for all edges e = v-&gt;w on the SPT: distTo[w] == distTo[v] + e.weight()</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(EdgeWeightedDigraph G, <span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// has a negative cycle</span></div><div class="line">        <span class="keyword">if</span> (hasNegativeCycle()) &#123;</div><div class="line">            <span class="keyword">double</span> weight = <span class="number">0.0</span>;</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : negativeCycle()) &#123;</div><div class="line">                weight += e.weight();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (weight &gt;= <span class="number">0.0</span>) &#123;</div><div class="line">                System.err.println(<span class="string">"error: weight of negative cycle = "</span> + weight);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// no negative cycle reachable from source</span></div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">            <span class="comment">// check that distTo[v] and edgeTo[v] are consistent</span></div><div class="line">            <span class="keyword">if</span> (distTo[s] != <span class="number">0.0</span> || edgeTo[s] != <span class="keyword">null</span>) &#123;</div><div class="line">                System.err.println(<span class="string">"distanceTo[s] and edgeTo[s] inconsistent"</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">                <span class="keyword">if</span> (v == s) <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span> (edgeTo[v] == <span class="keyword">null</span> &amp;&amp; distTo[v] != Double.POSITIVE_INFINITY) &#123;</div><div class="line">                    System.err.println(<span class="string">"distTo[] and edgeTo[] inconsistent"</span>);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// check that all edges e = v-&gt;w satisfy distTo[w] &lt;= distTo[v] + e.weight()</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">                <span class="keyword">for</span> (DirectedEdge e : G.adj(v)) &#123;</div><div class="line">                    <span class="keyword">int</span> w = e.to();</div><div class="line">                    <span class="keyword">if</span> (distTo[v] + e.weight() &lt; distTo[w]) &#123;</div><div class="line">                        System.err.println(<span class="string">"edge "</span> + e + <span class="string">" not relaxed"</span>);</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// check that all edges e = v-&gt;w on SPT satisfy distTo[w] == distTo[v] + e.weight()</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">0</span>; w &lt; G.V(); w++) &#123;</div><div class="line">                <span class="keyword">if</span> (edgeTo[w] == <span class="keyword">null</span>) <span class="keyword">continue</span>;</div><div class="line">                DirectedEdge e = edgeTo[w];</div><div class="line">                <span class="keyword">int</span> v = e.from();</div><div class="line">                <span class="keyword">if</span> (w != e.to()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                <span class="keyword">if</span> (distTo[v] + e.weight() != distTo[w]) &#123;</div><div class="line">                    System.err.println(<span class="string">"edge "</span> + e + <span class="string">" on shortest path not tight"</span>);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        StdOut.println(<span class="string">"Satisfies optimality conditions"</span>);</div><div class="line">        StdOut.println();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// throw an IllegalArgumentException unless &#123;@code 0 &lt;= v &lt; V&#125;</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">validateVertex</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> V = distTo.length;</div><div class="line">        <span class="keyword">if</span> (v &lt; <span class="number">0</span> || v &gt;= V)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"vertex "</span> + v + <span class="string">" is not between 0 and "</span> + (V-<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Unit tests the &#123;<span class="doctag">@code</span> BellmanFordSP&#125; data type.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> args the command-line arguments</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        In in = <span class="keyword">new</span> In(args[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">int</span> s = Integer.parseInt(args[<span class="number">1</span>]);</div><div class="line">        EdgeWeightedDigraph G = <span class="keyword">new</span> EdgeWeightedDigraph(in);</div><div class="line"></div><div class="line">        BellmanFordSP sp = <span class="keyword">new</span> BellmanFordSP(G, s);</div><div class="line"></div><div class="line">        <span class="comment">// print negative cycle</span></div><div class="line">        <span class="keyword">if</span> (sp.hasNegativeCycle()) &#123;</div><div class="line">            <span class="keyword">for</span> (DirectedEdge e : sp.negativeCycle())</div><div class="line">                StdOut.println(e);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// print shortest paths</span></div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; G.V(); v++) &#123;</div><div class="line">                <span class="keyword">if</span> (sp.hasPathTo(v)) &#123;</div><div class="line">                    StdOut.printf(<span class="string">"%d to %d (%5.2f)  "</span>, s, v, sp.distTo(v));</div><div class="line">                    <span class="keyword">for</span> (DirectedEdge e : sp.pathTo(v)) &#123;</div><div class="line">                        StdOut.print(e + <span class="string">"   "</span>);</div><div class="line">                    &#125;</div><div class="line">                    StdOut.println();</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span> &#123;</div><div class="line">                    StdOut.printf(<span class="string">"%d to %d           no path\n"</span>, s, v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/20/查找算法/" rel="prev" title="查找算法">
                查找算法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/header.jpg"
               alt="喝咖啡的鱼儿" />
          <p class="site-author-name" itemprop="name">喝咖啡的鱼儿</p>
           
              <p class="site-description motion-element" itemprop="description">愿你走出半生，归来仍是少年</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#图"><span class="nav-number">1.</span> <span class="nav-text">图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#无向图"><span class="nav-number">1.1.</span> <span class="nav-text">无向图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#邻接表"><span class="nav-number">1.1.1.</span> <span class="nav-text">邻接表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#深度优先搜索—-DFS"><span class="nav-number">1.2.</span> <span class="nav-text">深度优先搜索— DFS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#寻找路径"><span class="nav-number">1.2.1.</span> <span class="nav-text">寻找路径</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#使用深度优先搜索查找图中的路径"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">使用深度优先搜索查找图中的路径</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#广度优先搜索-BFS"><span class="nav-number">1.3.</span> <span class="nav-text">广度优先搜索   BFS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#连通分量"><span class="nav-number">1.3.1.</span> <span class="nav-text">连通分量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#检测环"><span class="nav-number">1.3.2.</span> <span class="nav-text">检测环</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#有向图"><span class="nav-number">1.4.</span> <span class="nav-text">有向图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最小生成树"><span class="nav-number">1.5.</span> <span class="nav-text">最小生成树</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#加权图"><span class="nav-number">1.5.1.</span> <span class="nav-text">加权图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#最小生成树-1"><span class="nav-number">1.5.2.</span> <span class="nav-text">最小生成树</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#切分定理"><span class="nav-number">1.5.3.</span> <span class="nav-text">切分定理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#贪心算法"><span class="nav-number">1.5.4.</span> <span class="nav-text">贪心算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加权无向图"><span class="nav-number">1.5.5.</span> <span class="nav-text">加权无向图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Prim-算法"><span class="nav-number">1.5.6.</span> <span class="nav-text">Prim 算法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Lazy-Prim-延时实现"><span class="nav-number">1.5.6.1.</span> <span class="nav-text">Lazy Prim 延时实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Prim-即时实现"><span class="nav-number">1.5.6.2.</span> <span class="nav-text">Prim  即时实现</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Kruskal-算法"><span class="nav-number">1.5.7.</span> <span class="nav-text">Kruskal 算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最短路径"><span class="nav-number">1.6.</span> <span class="nav-text">最短路径</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#最短路径树"><span class="nav-number">1.6.1.</span> <span class="nav-text">最短路径树</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加权有向边"><span class="nav-number">1.6.2.</span> <span class="nav-text">加权有向边</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加权有向图"><span class="nav-number">1.6.3.</span> <span class="nav-text">加权有向图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#松弛操作-Relaxation"><span class="nav-number">1.6.4.</span> <span class="nav-text">松弛操作 Relaxation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dijkstra-算法"><span class="nav-number">1.6.5.</span> <span class="nav-text">Dijkstra 算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加权有向无环图的最短路径算法"><span class="nav-number">1.7.</span> <span class="nav-text">加权有向无环图的最短路径算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Bellman-Ford-算法"><span class="nav-number">1.7.1.</span> <span class="nav-text">Bellman-Ford 算法</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">喝咖啡的鱼儿</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
